% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/api_define_extract.R
\name{add_to_extract_micro}
\alias{add_to_extract_micro}
\alias{add_to_extract.micro_extract}
\title{Add values to an existing extract definition for an IPUMS microdata
collection}
\usage{
\method{add_to_extract}{micro_extract}(
  extract,
  description = NULL,
  samples = NULL,
  variables = NULL,
  data_format = NULL,
  data_structure = NULL,
  rectangular_on = NULL,
  ...
)
}
\arguments{
\item{extract}{An \code{\link[=ipums_extract-class]{ipums_extract}} object.}

\item{description}{Description of the extract.}

\item{samples}{Character vector of sample names to include in the extract.
Samples should be specified using the sample ID codes for the given
project:
\itemize{
\item \href{https://usa.ipums.org/usa-action/samples/sample_ids}{IPUMS USA}
\item \href{https://cps.ipums.org/cps-action/samples/sample_ids}{IPUMS CPS}
\item \href{https://international.ipums.org/international-action/samples/sample_ids}{IPUMS International}
}}

\item{variables}{Character vector of variable names or a list of
\code{var_spec} objects created by \code{\link[=var_spec]{var_spec()}}
containing specifications for all variables to include in the extract.

If a variable already exists in the extract, its specifications
will be added to those that already exist for that variable.}

\item{data_format}{Format for the output extract data file. One of
\code{"fixed_width"}, \code{"csv"}, \code{"stata"}, \code{"spss"}, or \code{"sas9"}.}

\item{data_structure}{Data structure for the output the extract data.

\code{"rectangular"} provides person records with all requested household
information attached to respective household members.

\code{"hierarchical"} provides household records followed by person records.}

\item{rectangular_on}{If \code{data_structure} is \code{"rectangular"},
records on which to rectangularize. Currently only \code{"P"} (person records)
is supported.

Defaults to \code{"P"} if \code{data_structure} is \code{"rectangular"} and \code{NULL}
otherwise.}

\item{...}{Ignored}
}
\value{
A modified \code{micro_extract} object
}
\description{
Add new values or replace existing values in an IPUMS microdata extract
definition.

All fields are optional, and if omitted, will be unchanged. Supplying a value
for fields that take a single value, such as \code{description} and \code{data_format},
will replace the existing value with the supplied value.

To remove existing values from an IPUMS microdata extract definition, use
\code{\link[=remove_from_extract.micro_extract]{remove_from_extract()}}. To add values
contained in another extract definition, use \code{\link[=combine_extracts]{combine_extracts()}}.

Learn more about the IPUMS API in \code{vignette("ipums-api")}.
}
\details{
If the supplied extract definition comes from
a previously submitted extract request, this function will reset the
definition to an unsubmitted state.

To modify variable-specific parameters for variables that already exist
in the extract, create a new variable specification with \code{\link[=var_spec]{var_spec()}}.
}
\examples{
extract <- define_extract_usa(
  description = "2013 ACS Data",
  samples = "us2013a",
  variables = c("SEX", "AGE", "YEAR")
)

add_to_extract(extract, samples = "us2014a")

extract2 <- add_to_extract(
  extract,
  samples = "us2014a",
  variables = c("MARST", "BIRTHYR")
)

# Add new variable-specific specifications as you would when defining
# an extract, even to modify variables that already exist in the definition
add_to_extract(
  extract,
  samples = "us2014a",
  variables = list(
    var_spec("RACE", attached_characteristics = "mother"),
    var_spec("SEX", case_selections = "2")
  )
)

# Values that only take a single value are replaced
add_to_extract(extract, description = "New description")$description

# You can also combine two separate extract requests together
combine_extracts(extract, extract2)
}
\seealso{
\code{\link[=remove_from_extract.micro_extract]{remove_from_extract()}} to remove
values from an extract definition.

\code{\link[=combine_extracts]{combine_extracts()}} to combine multiple extract definitions.

\code{\link[=submit_extract]{submit_extract()}} and \code{\link[=download_extract]{download_extract()}} to submit and process an
extract request.

\code{\link[=define_extract]{define_extract_*()}} to create a new extract definition
from scratch
}
\keyword{internal}
