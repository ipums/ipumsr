<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='Wait for an extract request to finish by periodically checking its status
via the IPUMS API until it is complete.
is_extract_ready() is a convenience function to check if an extract
is ready to download without committing your R session to waiting for
extract completion.
Learn more about the IPUMS API in vignette("ipums-api").'><title>Wait for an extract request to finish processing — wait_for_extract • ipumsr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Wait for an extract request to finish processing — wait_for_extract"><meta property="og:description" content='Wait for an extract request to finish by periodically checking its status
via the IPUMS API until it is complete.
is_extract_ready() is a convenience function to check if an extract
is ready to download without committing your R session to waiting for
extract completion.
Learn more about the IPUMS API in vignette("ipums-api").'><meta property="og:image" content="http://tech.popdata.org/ipumsr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ipumsr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ipums.html">Get Started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>IPUMS Data</h6>
    <a class="dropdown-item" href="../articles/ipums-read.html">Read IPUMS data</a>
    <a class="dropdown-item" href="../articles/value-labels.html">Value labels</a>
    <a class="dropdown-item" href="../articles/ipums-bigdata.html">Big IPUMS data</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>IPUMS API</h6>
    <a class="dropdown-item" href="../articles/ipums-api.html">Introduction to the API</a>
    <a class="dropdown-item" href="../articles/ipums-api-micro.html">Microdata API requests</a>
    <a class="dropdown-item" href="../articles/ipums-api-nhgis.html">NHGIS API requests</a>
    <div class="dropdown-divider"></div>
    <a class="external-link dropdown-item" href="https://ipums.org/exercises.shtml">Project-specific exercises</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ipums/ipumsr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://forum.ipums.org">
    <span class="fa fa-users"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.ipums.org/">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Wait for an extract request to finish processing</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipums/ipumsr/blob/HEAD/R/api_process_extract.R" class="external-link"><code>R/api_process_extract.R</code></a></small>
      <div class="d-none name"><code>wait_for_extract.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wait for an extract request to finish by periodically checking its status
via the IPUMS API until it is complete.</p>
<p><code>is_extract_ready()</code> is a convenience function to check if an extract
is ready to download without committing your R session to waiting for
extract completion.</p>
<p>Learn more about the IPUMS API in <code><a href="../articles/ipums-api.html">vignette("ipums-api")</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wait_for_extract</span><span class="op">(</span></span>
<span>  <span class="va">extract</span>,</span>
<span>  initial_delay_seconds <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  max_delay_seconds <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  timeout_seconds <span class="op">=</span> <span class="fl">10800</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"IPUMS_API_KEY"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is_extract_ready</span><span class="op">(</span><span class="va">extract</span>, api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"IPUMS_API_KEY"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>extract</dt>
<dd><p>One of:</p><ul><li><p>An <code><a href="ipums_extract-class.html">ipums_extract</a></code> object</p></li>
<li><p>The data collection and extract number formatted as a string of the
form <code>"collection:number"</code> or as a vector of the form
<code>c("collection", number)</code></p></li>
<li><p>An extract number to be associated with your default IPUMS
collection. See <code><a href="set_ipums_default_collection.html">set_ipums_default_collection()</a></code></p></li>
</ul><p>For a list of codes used to refer to each collection, see
<code><a href="ipums_data_collections.html">ipums_data_collections()</a></code>.</p></dd>


<dt>initial_delay_seconds</dt>
<dd><p>Seconds to wait before first status check. The
wait time will automatically increase by 10 seconds between each
successive check.</p></dd>


<dt>max_delay_seconds</dt>
<dd><p>Maximum interval to wait between status checks.
When the wait interval reaches this value, checks will continue to
occur at <code>max_delay_seconds</code> intervals until the extract is complete or
<code>timeout_seconds</code> is reached. Defaults to 300 seconds (5 minutes).</p></dd>


<dt>timeout_seconds</dt>
<dd><p>Maximum total number of seconds to continue waiting
for the extract before throwing an error. Defaults to 10,800 seconds (3
hours).</p></dd>


<dt>verbose</dt>
<dd><p>If <code>TRUE</code>, print status updates to the R console at the
beginning of each wait interval and upon extract completion.
Defaults to <code>TRUE</code>.</p></dd>


<dt>api_key</dt>
<dd><p>API key associated with your user account. Defaults to the
value of the <code>IPUMS_API_KEY</code> environment variable. See
<code><a href="set_ipums_api_key.html">set_ipums_api_key()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For <code>wait_for_extract()</code>, an
<code><a href="ipums_extract-class.html">ipums_extract</a></code> object containing the extract
definition and the URLs from which to download extract files.</p>


<p>For <code>is_extract_ready()</code>, a logical value indicating
whether the extract is ready to download.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>status</code> of a submitted extract will be one of <code>"queued"</code>, <code>"started"</code>,
<code>"produced"</code>, <code>"canceled"</code>, <code>"failed"</code>, or <code>"completed"</code>.</p>
<p>To be ready to download, an extract must have a <code>"completed"</code> status.
However, some requests that are <code>"completed"</code> may still be unavailable for
download, as extracts expire and are removed from IPUMS servers after a set
period of time (72 hours for microdata collections, 2 weeks for IPUMS NHGIS).</p>
<p>Therefore, these functions also check the <code>download_links</code> field of the
extract request to determine if data are available for download. If an
extract has expired (that is, it has completed but its download links are
no longer available), these functions will warn that the extract request
must be resubmitted.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="download_extract.html">download_extract()</a></code> to download an extract's data files.</p>
<p><code><a href="get_extract_info.html">get_extract_info()</a></code> to obtain the definition of a submitted extract request.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">my_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="define_extract-micro.html">define_extract_ipumsi</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  description <span class="op">=</span> <span class="st">"Botswana data"</span>,</span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bw2001a"</span>, <span class="st">"bw2011a"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEX"</span>, <span class="st">"AGE"</span>, <span class="st">"YEAR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">submitted_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="submit_extract.html">submit_extract</a></span><span class="op">(</span><span class="va">my_extract</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Wait for a particular extract request to complete by providing its</span></span></span>
<span class="r-in"><span><span class="co"># associated `ipums_extract` object:</span></span></span>
<span class="r-in"><span><span class="va">downloadable_extract</span> <span class="op">&lt;-</span> <span class="fu">wait_for_extract</span><span class="op">(</span><span class="va">submitted_extract</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or by specifying the collection and number for the extract request:</span></span></span>
<span class="r-in"><span><span class="va">downloadable_extract</span> <span class="op">&lt;-</span> <span class="fu">wait_for_extract</span><span class="op">(</span><span class="st">"ipumsi:1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If you have a default collection, you can use the extract number alone:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_ipums_default_collection.html">set_ipums_default_collection</a></span><span class="op">(</span><span class="st">"ipumsi"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">downloadable_extract</span> <span class="op">&lt;-</span> <span class="fu">wait_for_extract</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use `download_extract()` to download the completed extract:</span></span></span>
<span class="r-in"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="download_extract.html">download_extract</a></span><span class="op">(</span><span class="va">downloadable_extract</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use `is_extract_ready()` if you don't want to tie up your R session by</span></span></span>
<span class="r-in"><span><span class="co"># waiting for completion</span></span></span>
<span class="r-in"><span><span class="fu">is_extract_ready</span><span class="op">(</span><span class="st">"usa:1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://www.ipums.org" class="external-link">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

