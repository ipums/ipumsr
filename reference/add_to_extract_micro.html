<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add values to an existing extract definition for an IPUMS microdata collection — add_to_extract_micro • ipumsr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Add values to an existing extract definition for an IPUMS microdata collection — add_to_extract_micro"><meta name="description" content='
Add new values or replace existing values in an IPUMS microdata extract
definition. All fields are optional, and if omitted, will be unchanged.
Supplying a value
for fields that take a single value, such as description and data_format,
will replace the existing value with the supplied value.
This function is marked as experimental because it is typically not the best
option for maintaining reproducible extract definitions and may be retired
in the future. For reproducibility, users should strive to build extract
definitions with define_extract_micro().
If you have a complicated extract definition to revise, but do not have
the original extract definition code that created it, we suggest that you
save the revised extract as a JSON file with save_extract_as_json(). This
will create a stable version of the extract definition that
can be used in the future as needed.
To remove existing values from an IPUMS microdata extract definition, use
remove_from_extract().
Learn more about the IPUMS API in vignette("ipums-api").'><meta property="og:description" content='
Add new values or replace existing values in an IPUMS microdata extract
definition. All fields are optional, and if omitted, will be unchanged.
Supplying a value
for fields that take a single value, such as description and data_format,
will replace the existing value with the supplied value.
This function is marked as experimental because it is typically not the best
option for maintaining reproducible extract definitions and may be retired
in the future. For reproducibility, users should strive to build extract
definitions with define_extract_micro().
If you have a complicated extract definition to revise, but do not have
the original extract definition code that created it, we suggest that you
save the revised extract as a JSON file with save_extract_as_json(). This
will create a stable version of the extract definition that
can be used in the future as needed.
To remove existing values from an IPUMS microdata extract definition, use
remove_from_extract().
Learn more about the IPUMS API in vignette("ipums-api").'><meta property="og:image" content="https://tech.popdata.org/ipumsr/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ipumsr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ipums.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>IPUMS Data</h6></li>
    <li><a class="dropdown-item" href="../articles/ipums-read.html">Read IPUMS data</a></li>
    <li><a class="dropdown-item" href="../articles/value-labels.html">Value labels</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-bigdata.html">Big IPUMS data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>IPUMS API</h6></li>
    <li><a class="dropdown-item" href="../articles/ipums-api.html">Introduction to the API</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-api-micro.html">Microdata API requests</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-api-nhgis.html">NHGIS API requests</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="external-link dropdown-item" href="https://ipums.org/exercises.shtml">Project-specific exercises</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipums/ipumsr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://forum.ipums.org" aria-label="IPUMS User Forum"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.ipums.org/" aria-label="IPUMS website"><span class="fa fa-globe"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Add values to an existing extract definition for an IPUMS microdata collection</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipums/ipumsr/blob/v0.8.2/R/api_define_extract.R" class="external-link"><code>R/api_define_extract.R</code></a></small>
      <div class="d-none name"><code>add_to_extract_micro.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Add new values or replace existing values in an IPUMS microdata extract
definition. All fields are optional, and if omitted, will be unchanged.
Supplying a value
for fields that take a single value, such as <code>description</code> and <code>data_format</code>,
will replace the existing value with the supplied value.</p>
<p>This function is marked as experimental because it is typically not the best
option for maintaining reproducible extract definitions and may be retired
in the future. For reproducibility, users should strive to build extract
definitions with <code><a href="define_extract_micro.html">define_extract_micro()</a></code>.</p>
<p>If you have a complicated extract definition to revise, but do not have
the original extract definition code that created it, we suggest that you
save the revised extract as a JSON file with <code><a href="save_extract_as_json.html">save_extract_as_json()</a></code>. This
will create a stable version of the extract definition that
can be used in the future as needed.</p>
<p>To remove existing values from an IPUMS microdata extract definition, use
<code><a href="remove_from_extract.micro_extract.html">remove_from_extract()</a></code>.</p>
<p>Learn more about the IPUMS API in <code><a href="../articles/ipums-api.html">vignette("ipums-api")</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'micro_extract'</span></span>
<span><span class="fu"><a href="add_to_extract.html">add_to_extract</a></span><span class="op">(</span></span>
<span>  <span class="va">extract</span>,</span>
<span>  description <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time_use_variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sample_members <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data_format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data_structure <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rectangular_on <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  case_select_who <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data_quality_flags <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-extract">extract<a class="anchor" aria-label="anchor" href="#arg-extract"></a></dt>
<dd><p>An <code><a href="ipums_extract-class.html">ipums_extract</a></code> object.</p></dd>


<dt id="arg-description">description<a class="anchor" aria-label="anchor" href="#arg-description"></a></dt>
<dd><p>Description of the extract.</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Vector of samples to include in the extract
request. Use <code><a href="get_sample_info.html">get_sample_info()</a></code> to identify
sample IDs for a given collection.</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>Character vector of variable names or a list of
<code>var_spec</code> objects created by <code><a href="var_spec.html">var_spec()</a></code>
containing specifications for all variables to include in the extract.</p>
<p>If a variable already exists in the extract, its specifications
will be added to those that already exist for that variable.</p></dd>


<dt id="arg-time-use-variables">time_use_variables<a class="anchor" aria-label="anchor" href="#arg-time-use-variables"></a></dt>
<dd><p>Vector of names of IPUMS-defined time use variables
or a list of specifications for user-defined time use variables
to include in the extract request. Use <code><a href="var_spec.html">tu_var_spec()</a></code> to create a
<code>tu_var_spec</code> object containing a time use variable specification.</p></dd>


<dt id="arg-sample-members">sample_members<a class="anchor" aria-label="anchor" href="#arg-sample-members"></a></dt>
<dd><p>Indication of whether to include additional sample
members in the extract request. If provided, must be one of
<code>"include_non_respondents"</code>, <code>"include_household_members"</code>, or both.</p>
<p>Sample member selection is only available for the IPUMS ATUS collection
(<code>"atus"</code>).</p></dd>


<dt id="arg-data-format">data_format<a class="anchor" aria-label="anchor" href="#arg-data-format"></a></dt>
<dd><p>Format for the output extract data file. Either
<code>"fixed_width"</code> or <code>"csv"</code>.</p>
<p>Note that while <code>"stata"</code>, <code>"spss"</code>, or <code>"sas9"</code> are also accepted, these
file formats are not supported by ipumsr data-reading functions.</p></dd>


<dt id="arg-data-structure">data_structure<a class="anchor" aria-label="anchor" href="#arg-data-structure"></a></dt>
<dd><p>Data structure for the output extract data.</p><ul><li><p><code>"rectangular"</code> provides data in which every row has the same record type
(determined by <code>"rectangular_on"</code>), with variables from other record types
written onto associated records of the chosen type (e.g. household
variables written onto person records).</p></li>
<li><p><code>"hierarchical"</code> provides data that include rows of differing record
types, with records ordered according to their hierarchical structure (e.g.
each person record is followed by the activity records for that person).</p></li>
<li><p><code>"household_only"</code> provides household records only. This data structure
is only available for the IPUMS USA collection (<code>"usa"</code>).</p></li>
</ul></dd>


<dt id="arg-rectangular-on">rectangular_on<a class="anchor" aria-label="anchor" href="#arg-rectangular-on"></a></dt>
<dd><p>If <code>data_structure</code> is <code>"rectangular"</code>,
records on which to rectangularize. One of <code>"P"</code> (person), <code>"A"</code>
(activity), <code>"I"</code> (injury) or <code>"R"</code> (round).</p>
<p>Defaults to <code>"P"</code> if <code>data_structure</code> is <code>"rectangular"</code> and <code>NULL</code>
otherwise.</p></dd>


<dt id="arg-case-select-who">case_select_who<a class="anchor" aria-label="anchor" href="#arg-case-select-who"></a></dt>
<dd><p>Indication of how to interpret any case selections
included for variables in the extract definition.</p><ul><li><p><code>"individuals"</code> includes records for all individuals who match the
specified case selections.</p></li>
<li><p><code>"households"</code> includes records for all members of each household that
contains an individual who matches the specified case selections.</p></li>
</ul><p>Defaults to <code>"individuals"</code>. Use <code><a href="var_spec.html">var_spec()</a></code> to add case selections for
specific variables.</p></dd>


<dt id="arg-data-quality-flags">data_quality_flags<a class="anchor" aria-label="anchor" href="#arg-data-quality-flags"></a></dt>
<dd><p>Set to <code>TRUE</code> to include data quality
flags for all applicable variables in the extract definition. This will
override the <code>data_quality_flags</code> specification for individual variables
in the definition.</p>
<p>Use <code><a href="var_spec.html">var_spec()</a></code> to add data quality flags for specific variables.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ignored</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A modified <code>micro_extract</code> object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the supplied extract definition comes from
a previously submitted extract request, this function will reset the
definition to an unsubmitted state.</p>
<p>To modify variable-specific parameters for variables that already exist
in the extract, create a new variable specification with <code><a href="var_spec.html">var_spec()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="remove_from_extract.micro_extract.html">remove_from_extract()</a></code> to remove
values from an extract definition.</p>
<p><code><a href="submit_extract.html">submit_extract()</a></code> to submit an extract request.</p>
<p><code><a href="download_extract.html">download_extract()</a></code> to download extract data files.</p>
<p><code><a href="define_extract_micro.html">define_extract_micro()</a></code> to create a new extract
definition from scratch</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="define_extract_micro.html">define_extract_micro</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  collection <span class="op">=</span> <span class="st">"usa"</span>,</span></span>
<span class="r-in"><span>  description <span class="op">=</span> <span class="st">"2013 ACS Data"</span>,</span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="st">"us2013a"</span>,</span></span>
<span class="r-in"><span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEX"</span>, <span class="st">"AGE"</span>, <span class="st">"YEAR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a single sample</span></span></span>
<span class="r-in"><span><span class="fu"><a href="add_to_extract.html">add_to_extract</a></span><span class="op">(</span><span class="va">extract</span>, samples <span class="op">=</span> <span class="st">"us2014a"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unsubmitted IPUMS USA extract </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Description: 2013 ACS Data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Samples: </span>(2 total) us2013a, us2014a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Variables: </span>(3 total) SEX, AGE, YEAR</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add samples and variables</span></span></span>
<span class="r-in"><span><span class="va">extract2</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_to_extract.html">add_to_extract</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">extract</span>,</span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="st">"us2014a"</span>,</span></span>
<span class="r-in"><span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MARST"</span>, <span class="st">"BIRTHYR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Modify specifications for variables in the extract by using `var_spec()`</span></span></span>
<span class="r-in"><span><span class="co"># with the existing variable name:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="add_to_extract.html">add_to_extract</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">extract</span>,</span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="st">"us2014a"</span>,</span></span>
<span class="r-in"><span>  variables <span class="op">=</span> <span class="fu"><a href="var_spec.html">var_spec</a></span><span class="op">(</span><span class="st">"SEX"</span>, case_selections <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unsubmitted IPUMS USA extract </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Description: 2013 ACS Data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Samples: </span>(2 total) us2013a, us2014a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Variables: </span>(3 total) SEX, AGE, YEAR</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can make multiple modifications or additions by providing a list</span></span></span>
<span class="r-in"><span><span class="co"># of `var_spec()` objects:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="add_to_extract.html">add_to_extract</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">extract</span>,</span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="st">"us2014a"</span>,</span></span>
<span class="r-in"><span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="var_spec.html">var_spec</a></span><span class="op">(</span><span class="st">"RACE"</span>, attached_characteristics <span class="op">=</span> <span class="st">"mother"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="var_spec.html">var_spec</a></span><span class="op">(</span><span class="st">"SEX"</span>, case_selections <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="var_spec.html">var_spec</a></span><span class="op">(</span><span class="st">"RELATE"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unsubmitted IPUMS USA extract </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Description: 2013 ACS Data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Samples: </span>(2 total) us2013a, us2014a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Variables: </span>(5 total) SEX, AGE, YEAR, RACE, RELATE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Values that only take a single value are replaced</span></span></span>
<span class="r-in"><span><span class="fu"><a href="add_to_extract.html">add_to_extract</a></span><span class="op">(</span><span class="va">extract</span>, description <span class="op">=</span> <span class="st">"New description"</span><span class="op">)</span><span class="op">$</span><span class="va">description</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "New description"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.ipums.org" class="external-link">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

