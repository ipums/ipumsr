<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Wait for an extract request to finish processing — wait_for_extract • ipumsr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Wait for an extract request to finish processing — wait_for_extract"><meta name="description" content='Wait for an extract request to finish by periodically checking its status
via the IPUMS API until it is complete.
is_extract_ready() is a convenience function to check if an extract
is ready to download without committing your R session to waiting for
extract completion.
Learn more about the IPUMS API in vignette("ipums-api").'><meta property="og:description" content='Wait for an extract request to finish by periodically checking its status
via the IPUMS API until it is complete.
is_extract_ready() is a convenience function to check if an extract
is ready to download without committing your R session to waiting for
extract completion.
Learn more about the IPUMS API in vignette("ipums-api").'><meta property="og:image" content="https://tech.popdata.org/ipumsr/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ipumsr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.8.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/ipums.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>IPUMS Data</h6></li>
    <li><a class="dropdown-item" href="../articles/ipums-read.html">Read IPUMS data</a></li>
    <li><a class="dropdown-item" href="../articles/value-labels.html">Value labels</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-bigdata.html">Big IPUMS data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>IPUMS API</h6></li>
    <li><a class="dropdown-item" href="../articles/ipums-api.html">Introduction to the API</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-api-micro.html">Microdata API requests</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-api-nhgis.html">NHGIS API requests</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="external-link dropdown-item" href="https://ipums.org/exercises.shtml">Project-specific exercises</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipums/ipumsr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://forum.ipums.org" aria-label="IPUMS User Forum"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.ipums.org/" aria-label="IPUMS website"><span class="fa fa-globe"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Wait for an extract request to finish processing</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipums/ipumsr/blob/main/R/api_process_extract.R" class="external-link"><code>R/api_process_extract.R</code></a></small>
      <div class="d-none name"><code>wait_for_extract.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wait for an extract request to finish by periodically checking its status
via the IPUMS API until it is complete.</p>
<p><code>is_extract_ready()</code> is a convenience function to check if an extract
is ready to download without committing your R session to waiting for
extract completion.</p>
<p>Learn more about the IPUMS API in <code><a href="../articles/ipums-api.html">vignette("ipums-api")</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wait_for_extract</span><span class="op">(</span></span>
<span>  <span class="va">extract</span>,</span>
<span>  initial_delay_seconds <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  max_delay_seconds <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  timeout_seconds <span class="op">=</span> <span class="fl">10800</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"IPUMS_API_KEY"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is_extract_ready</span><span class="op">(</span><span class="va">extract</span>, api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"IPUMS_API_KEY"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-extract">extract<a class="anchor" aria-label="anchor" href="#arg-extract"></a></dt>
<dd><p>One of:</p><ul><li><p>An <code><a href="ipums_extract-class.html">ipums_extract</a></code> object</p></li>
<li><p>The data collection and extract number formatted as a string of the
form <code>"collection:number"</code> or as a vector of the form
<code>c("collection", number)</code></p></li>
<li><p>An extract number to be associated with your default IPUMS
collection. See <code><a href="set_ipums_default_collection.html">set_ipums_default_collection()</a></code></p></li>
</ul><p>For a list of codes used to refer to each collection, see
<code><a href="ipums_data_collections.html">ipums_data_collections()</a></code>.</p></dd>


<dt id="arg-initial-delay-seconds">initial_delay_seconds<a class="anchor" aria-label="anchor" href="#arg-initial-delay-seconds"></a></dt>
<dd><p>Seconds to wait before first status check. The
wait time will automatically increase by 10 seconds between each
successive check.</p></dd>


<dt id="arg-max-delay-seconds">max_delay_seconds<a class="anchor" aria-label="anchor" href="#arg-max-delay-seconds"></a></dt>
<dd><p>Maximum interval to wait between status checks.
When the wait interval reaches this value, checks will continue to
occur at <code>max_delay_seconds</code> intervals until the extract is complete or
<code>timeout_seconds</code> is reached. Defaults to 300 seconds (5 minutes).</p></dd>


<dt id="arg-timeout-seconds">timeout_seconds<a class="anchor" aria-label="anchor" href="#arg-timeout-seconds"></a></dt>
<dd><p>Maximum total number of seconds to continue waiting
for the extract before throwing an error. Defaults to 10,800 seconds (3
hours).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If <code>TRUE</code>, print status updates to the R console at the
beginning of each wait interval and upon extract completion.
Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-api-key">api_key<a class="anchor" aria-label="anchor" href="#arg-api-key"></a></dt>
<dd><p>API key associated with your user account. Defaults to the
value of the <code>IPUMS_API_KEY</code> environment variable. See
<code><a href="set_ipums_api_key.html">set_ipums_api_key()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>For <code>wait_for_extract()</code>, an
<code><a href="ipums_extract-class.html">ipums_extract</a></code> object containing the extract
definition and the URLs from which to download extract files.</p>
<p>For <code>is_extract_ready()</code>, a logical value indicating
whether the extract is ready to download.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>status</code> of a submitted extract will be one of <code>"queued"</code>, <code>"started"</code>,
<code>"produced"</code>, <code>"canceled"</code>, <code>"failed"</code>, or <code>"completed"</code>.</p>
<p>To be ready to download, an extract must have a <code>"completed"</code> status.
However, some requests that are <code>"completed"</code> may still be unavailable for
download, as extracts expire and are removed from IPUMS servers after a set
period of time (72 hours for microdata collections, 2 weeks for IPUMS NHGIS).</p>
<p>Therefore, these functions also check the <code>download_links</code> field of the
extract request to determine if data are available for download. If an
extract has expired (that is, it has completed but its download links are
no longer available), these functions will warn that the extract request
must be resubmitted.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="download_extract.html">download_extract()</a></code> to download an extract's data files.</p>
<p><code><a href="get_extract_info.html">get_extract_info()</a></code> to obtain the definition of a submitted extract request.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">my_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="define_extract_micro.html">define_extract_micro</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  collection <span class="op">=</span> <span class="st">"ipumsi"</span>,</span></span>
<span class="r-in"><span>  description <span class="op">=</span> <span class="st">"Botswana data"</span>,</span></span>
<span class="r-in"><span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bw2001a"</span>, <span class="st">"bw2011a"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEX"</span>, <span class="st">"AGE"</span>, <span class="st">"YEAR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">submitted_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="submit_extract.html">submit_extract</a></span><span class="op">(</span><span class="va">my_extract</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Wait for a particular extract request to complete by providing its</span></span></span>
<span class="r-in"><span><span class="co"># associated `ipums_extract` object:</span></span></span>
<span class="r-in"><span><span class="va">downloadable_extract</span> <span class="op">&lt;-</span> <span class="fu">wait_for_extract</span><span class="op">(</span><span class="va">submitted_extract</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or by specifying the collection and number for the extract request:</span></span></span>
<span class="r-in"><span><span class="va">downloadable_extract</span> <span class="op">&lt;-</span> <span class="fu">wait_for_extract</span><span class="op">(</span><span class="st">"ipumsi:1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If you have a default collection, you can use the extract number alone:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="set_ipums_default_collection.html">set_ipums_default_collection</a></span><span class="op">(</span><span class="st">"ipumsi"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">downloadable_extract</span> <span class="op">&lt;-</span> <span class="fu">wait_for_extract</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use `download_extract()` to download the completed extract:</span></span></span>
<span class="r-in"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="download_extract.html">download_extract</a></span><span class="op">(</span><span class="va">downloadable_extract</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use `is_extract_ready()` if you don't want to tie up your R session by</span></span></span>
<span class="r-in"><span><span class="co"># waiting for completion</span></span></span>
<span class="r-in"><span><span class="fu">is_extract_ready</span><span class="op">(</span><span class="st">"usa:1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.ipums.org" class="external-link">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

