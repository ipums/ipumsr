<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Modify value labels for a labelled vector — lbl_relabel • ipumsr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Modify value labels for a labelled vector — lbl_relabel"><meta name="description" content="Update the mapping between values and labels in a
labelled vector. These functions allow you to
simultaneously update data values and the existing value labels.
Modifying data values directly does not result in updated value labels.
Use lbl_relabel() to manually specify new value/label mappings. This
allows for the addition of new labels.
Use lbl_collapse() to collapse detailed labels into more general
categories. Values can be grouped together and associated with individual
labels that already exist in the labelled vector.
Unlabelled values will be converted to NA."><meta property="og:description" content="Update the mapping between values and labels in a
labelled vector. These functions allow you to
simultaneously update data values and the existing value labels.
Modifying data values directly does not result in updated value labels.
Use lbl_relabel() to manually specify new value/label mappings. This
allows for the addition of new labels.
Use lbl_collapse() to collapse detailed labels into more general
categories. Values can be grouped together and associated with individual
labels that already exist in the labelled vector.
Unlabelled values will be converted to NA."><meta property="og:image" content="http://tech.popdata.org/ipumsr/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ipumsr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/ipums.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>IPUMS Data</h6></li>
    <li><a class="dropdown-item" href="../articles/ipums-read.html">Read IPUMS data</a></li>
    <li><a class="dropdown-item" href="../articles/value-labels.html">Value labels</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-bigdata.html">Big IPUMS data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>IPUMS API</h6></li>
    <li><a class="dropdown-item" href="../articles/ipums-api.html">Introduction to the API</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-api-micro.html">Microdata API requests</a></li>
    <li><a class="dropdown-item" href="../articles/ipums-api-nhgis.html">NHGIS API requests</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="external-link dropdown-item" href="https://ipums.org/exercises.shtml">Project-specific exercises</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipums/ipumsr"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://forum.ipums.org"><span class="fa fa-users"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://www.ipums.org/"><span class="fa fa-globe"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Modify value labels for a labelled vector</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipums/ipumsr/blob/main/R/lbl_helpers.R" class="external-link"><code>R/lbl_helpers.R</code></a></small>
      <div class="d-none name"><code>lbl_relabel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Update the mapping between values and labels in a
<code><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></code> vector. These functions allow you to
simultaneously update data values and the existing value labels.
Modifying data values directly does not result in updated value labels.</p>
<p>Use <code>lbl_relabel()</code> to manually specify new value/label mappings. This
allows for the addition of new labels.</p>
<p>Use <code>lbl_collapse()</code> to collapse detailed labels into more general
categories. Values can be grouped together and associated with individual
labels that already exist in the <code>labelled</code> vector.</p>
<p>Unlabelled values will be converted to <code>NA</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lbl_relabel</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lbl_collapse</span><span class="op">(</span><span class="va">x</span>, <span class="va">.fun</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <code><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></code> vector</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arbitrary number of two-sided formulas.</p>
<p>The left hand side should be a label placeholder created with <code><a href="lbl.html">lbl()</a></code> or a
value that already exists in the data.</p>
<p>The right hand side should be a function taking <code>.val</code> and <code>.lbl</code>
arguments that evaluates to <code>TRUE</code> for all
cases that should receive the label specified on the left hand side.</p>
<p>Can be provided as an anonymous function or formula. See Details section.</p></dd>


<dt id="arg--fun">.fun<a class="anchor" aria-label="anchor" href="#arg--fun"></a></dt>
<dd><p>A function taking <code>.val</code> and <code>.lbl</code> arguments that returns
the value associated with an existing label in the vector. Input values to
this function will be relabeled with the label of the function's output
value.</p>
<p>Can be provided as an anonymous function or formula. See Details section.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></code> vector</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Several <code>lbl_*()</code> functions include arguments that can be passed a function
of <code>.val</code> and/or <code>.lbl</code>. These refer to the existing values and
labels in the input vector, respectively.</p>
<p>Use <code>.val</code> to refer to the <em>values</em> in the vector's value labels.
Use <code>.lbl</code> to refer to the <em>label names</em> in the vector's value labels.</p>
<p>Note that not all <code>lbl_*()</code> functions support both of these arguments.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other lbl_helpers:
<code><a href="lbl.html">lbl</a>()</code>,
<code><a href="lbl_add.html">lbl_add</a>()</code>,
<code><a href="lbl_clean.html">lbl_clean</a>()</code>,
<code><a href="lbl_define.html">lbl_define</a>()</code>,
<code><a href="lbl_na_if.html">lbl_na_if</a>()</code>,
<code><a href="zap_ipums_attributes.html">zap_ipums_attributes</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">30</span>, <span class="fl">99</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Yes <span class="op">=</span> <span class="fl">10</span>, `Yes - Logically Assigned` <span class="op">=</span> <span class="fl">11</span>,</span></span>
<span class="r-in"><span>    No <span class="op">=</span> <span class="fl">20</span>, Unlikely <span class="op">=</span> <span class="fl">21</span>, Maybe <span class="op">=</span> <span class="fl">30</span>, NIU <span class="op">=</span> <span class="fl">99</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert cases with value 11 to value 10 and associate with 10's label</span></span></span>
<span class="r-in"><span><span class="fu">lbl_relabel</span><span class="op">(</span><span class="va">x</span>, <span class="fl">10</span> <span class="op">~</span> <span class="va">.val</span> <span class="op">==</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 10 10 20 21 30 99 30 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value    label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10      Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21 Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30    Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     99      NIU</span>
<span class="r-in"><span><span class="fu">lbl_relabel</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="lbl.html">lbl</a></span><span class="op">(</span><span class="st">"Yes"</span><span class="op">)</span> <span class="op">~</span> <span class="va">.val</span> <span class="op">==</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 10 10 20 21 30 99 30 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value    label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10      Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21 Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30    Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     99      NIU</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To relabel using new value/label pairs, use `lbl()` to define a new pair</span></span></span>
<span class="r-in"><span><span class="fu">lbl_relabel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">x</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="lbl.html">lbl</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"Yes/Yes-ish"</span><span class="op">)</span> <span class="op">~</span> <span class="va">.val</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="lbl.html">lbl</a></span><span class="op">(</span><span class="fl">90</span>, <span class="st">"???"</span><span class="op">)</span> <span class="op">~</span> <span class="va">.val</span> <span class="op">==</span> <span class="fl">99</span> <span class="op">|</span> <span class="va">.lbl</span> <span class="op">==</span> <span class="st">"Maybe"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 10 10 20 21 90 90 90 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value       label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10 Yes/Yes-ish</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20          No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21    Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     90         ???</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Collapse labels to create new label groups</span></span></span>
<span class="r-in"><span><span class="fu">lbl_collapse</span><span class="op">(</span><span class="va">x</span>, <span class="op">~</span> <span class="op">(</span><span class="va">.val</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 10 10 20 20 30 90 30 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10   Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20    No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30 Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     90   NIU</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># These are equivalent</span></span></span>
<span class="r-in"><span><span class="fu">lbl_collapse</span><span class="op">(</span><span class="va">x</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.val</span> <span class="op">==</span> <span class="fl">10</span>, <span class="fl">11</span>, <span class="va">.val</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11 11 11 20 21 30 99 30 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value                    label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     11 Yes - Logically Assigned</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20                       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21                 Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30                    Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     99                      NIU</span>
<span class="r-in"><span><span class="fu">lbl_relabel</span><span class="op">(</span><span class="va">x</span>, <span class="fl">11</span> <span class="op">~</span> <span class="va">.val</span> <span class="op">==</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11 11 11 20 21 30 99 30 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value                    label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     11 Yes - Logically Assigned</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20                       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21                 Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30                    Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     99                      NIU</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.ipums.org" class="external-link">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

