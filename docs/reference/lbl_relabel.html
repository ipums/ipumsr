<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Modify value labels for a labelled vector — lbl_relabel • ipumsr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Modify value labels for a labelled vector — lbl_relabel"><meta property="og:description" content="Update the mapping between values and labels in a
labelled vector. These functions allow you to
simultaneously update data values and the existing value labels.
Modifying data values directly does not result in updated value labels.
Use lbl_relabel() to manually specify new value/label mappings. This
allows for the addition of new labels.
Use lbl_collapse() to collapse detailed labels into more general
categories. Values can be grouped together and associated with individual
labels that already exist in the labelled vector.
Unlabelled values will be converted to NA."><meta property="og:image" content="http://tech.popdata.org/ipumsr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ipumsr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ipums.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">IPUMS Data</li>
    <li>
      <a href="../articles/ipums-read.html">Read IPUMS data</a>
    </li>
    <li>
      <a href="../articles/value-labels.html">Value labels</a>
    </li>
    <li>
      <a href="../articles/ipums-bigdata.html">Big IPUMS data</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">IPUMS API</li>
    <li>
      <a href="../articles/ipums-api.html">Introduction to the API</a>
    </li>
    <li>
      <a href="../articles/ipums-api-micro.html">Microdata API requests</a>
    </li>
    <li>
      <a href="../articles/ipums-api-nhgis.html">NHGIS API requests</a>
    </li>
    <li class="divider">
    <li>
      <a href="https://ipums.org/exercises.shtml" class="external-link">Project-specific exercises</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ipums/ipumsr" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://forum.ipums.org" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
<li>
  <a href="https://www.ipums.org/" class="external-link">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Modify value labels for a labelled vector</h1>
    <small class="dont-index">Source: <a href="https://github.com/ipums/ipumsr/blob/HEAD/R/lbl_helpers.R" class="external-link"><code>R/lbl_helpers.R</code></a></small>
    <div class="hidden name"><code>lbl_relabel.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Update the mapping between values and labels in a
<code><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></code> vector. These functions allow you to
simultaneously update data values and the existing value labels.
Modifying data values directly does not result in updated value labels.</p>
<p>Use <code>lbl_relabel()</code> to manually specify new value/label mappings. This
allows for the addition of new labels.</p>
<p>Use <code>lbl_collapse()</code> to collapse detailed labels into more general
categories. Values can be grouped together and associated with individual
labels that already exist in the <code>labelled</code> vector.</p>
<p>Unlabelled values will be converted to <code>NA</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lbl_relabel</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">lbl_collapse</span><span class="op">(</span><span class="va">x</span>, <span class="va">.fun</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A <code><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></code> vector</p></dd>


<dt>...</dt>
<dd><p>Arbitrary number of two-sided formulas.</p>
<p>The left hand side should be a label placeholder created with <code><a href="lbl.html">lbl()</a></code> or a
value that already exists in the data.</p>
<p>The right hand side should be a function taking <code>.val</code> and <code>.lbl</code>
arguments that evaluates to <code>TRUE</code> for all
cases that should receive the label specified on the left hand side.</p>
<p>Can be provided as an anonymous function or formula. See Details section.</p></dd>


<dt>.fun</dt>
<dd><p>A function taking <code>.val</code> and <code>.lbl</code> arguments that returns
the value associated with an existing label in the vector. Input values to
this function will be relabeled with the label of the function's output
value.</p>
<p>Can be provided as an anonymous function or formula. See Details section.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></code> vector</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Several <code>lbl_*()</code> functions include arguments that can be passed a function
of <code>.val</code> and/or <code>.lbl</code>. These refer to the existing values and
labels in the input vector, respectively.</p>
<p>Use <code>.val</code> to refer to the <em>values</em> in the vector's value labels.
Use <code>.lbl</code> to refer to the <em>label names</em> in the vector's value labels.</p>
<p>Note that not all <code>lbl_*()</code> functions support both of these arguments.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other lbl_helpers: 
<code><a href="lbl_add.html">lbl_add</a>()</code>,
<code><a href="lbl_clean.html">lbl_clean</a>()</code>,
<code><a href="lbl_define.html">lbl_define</a>()</code>,
<code><a href="lbl_na_if.html">lbl_na_if</a>()</code>,
<code><a href="lbl.html">lbl</a>()</code>,
<code><a href="zap_ipums_attributes.html">zap_ipums_attributes</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/labelled.html" class="external-link">labelled</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">30</span>, <span class="fl">99</span>, <span class="fl">30</span>, <span class="fl">10</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Yes <span class="op">=</span> <span class="fl">10</span>, `Yes - Logically Assigned` <span class="op">=</span> <span class="fl">11</span>,</span></span>
<span class="r-in"><span>    No <span class="op">=</span> <span class="fl">20</span>, Unlikely <span class="op">=</span> <span class="fl">21</span>, Maybe <span class="op">=</span> <span class="fl">30</span>, NIU <span class="op">=</span> <span class="fl">99</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert cases with value 11 to value 10 and associate with 10's label</span></span></span>
<span class="r-in"><span><span class="fu">lbl_relabel</span><span class="op">(</span><span class="va">x</span>, <span class="fl">10</span> <span class="op">~</span> <span class="va">.val</span> <span class="op">==</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 10 10 20 21 30 99 30 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value    label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10      Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21 Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30    Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     99      NIU</span>
<span class="r-in"><span><span class="fu">lbl_relabel</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="lbl.html">lbl</a></span><span class="op">(</span><span class="st">"Yes"</span><span class="op">)</span> <span class="op">~</span> <span class="va">.val</span> <span class="op">==</span> <span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 10 10 20 21 30 99 30 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value    label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10      Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21 Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30    Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     99      NIU</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To relabel using new value/label pairs, use `lbl()` to define a new pair</span></span></span>
<span class="r-in"><span><span class="fu">lbl_relabel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">x</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="lbl.html">lbl</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">"Yes/Yes-ish"</span><span class="op">)</span> <span class="op">~</span> <span class="va">.val</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="lbl.html">lbl</a></span><span class="op">(</span><span class="fl">90</span>, <span class="st">"???"</span><span class="op">)</span> <span class="op">~</span> <span class="va">.val</span> <span class="op">==</span> <span class="fl">99</span> <span class="op">|</span> <span class="va">.lbl</span> <span class="op">==</span> <span class="st">"Maybe"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 10 10 20 21 90 90 90 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value       label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10 Yes/Yes-ish</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20          No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21    Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     90         ???</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Collapse labels to create new label groups</span></span></span>
<span class="r-in"><span><span class="fu">lbl_collapse</span><span class="op">(</span><span class="va">x</span>, <span class="op">~</span> <span class="op">(</span><span class="va">.val</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10 10 10 20 20 30 90 30 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     10   Yes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20    No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30 Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     90   NIU</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># These are equivalent</span></span></span>
<span class="r-in"><span><span class="fu">lbl_collapse</span><span class="op">(</span><span class="va">x</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">.val</span> <span class="op">==</span> <span class="fl">10</span>, <span class="fl">11</span>, <span class="va">.val</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11 11 11 20 21 30 99 30 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value                    label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     11 Yes - Logically Assigned</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20                       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21                 Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30                    Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     99                      NIU</span>
<span class="r-in"><span><span class="fu">lbl_relabel</span><span class="op">(</span><span class="va">x</span>, <span class="fl">11</span> <span class="op">~</span> <span class="va">.val</span> <span class="op">==</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;labelled&lt;double&gt;[9]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11 11 11 20 21 30 99 30 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Labels:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  value                    label</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     11 Yes - Logically Assigned</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     20                       No</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     21                 Unlikely</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     30                    Maybe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     99                      NIU</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.ipums.org" class="external-link">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> .</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '4ffa912ace97d2493f6ed39f20e94316',
    indexName: 'ipumsr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

