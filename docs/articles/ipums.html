<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>IPUMS Data and R • ipumsr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="IPUMS Data and R">
<meta property="og:description" content="ipumsr">
<meta property="og:image" content="http://tech.popdata.org/ipumsr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ipumsr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ipums.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">IPUMS Data</li>
    <li>
      <a href="../articles/ipums-read.html">Read IPUMS data</a>
    </li>
    <li>
      <a href="../articles/value-labels.html">Value labels</a>
    </li>
    <li>
      <a href="../articles/ipums-bigdata.html">Big IPUMS data</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">IPUMS API</li>
    <li>
      <a href="../articles/ipums-api.html">Introduction to the API</a>
    </li>
    <li>
      <a href="../articles/ipums-api-micro.html">Microdata API requests</a>
    </li>
    <li>
      <a href="../articles/ipums-api-nhgis.html">NHGIS API requests</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="https://ipums.org/exercises.shtml" class="external-link">Project-specific exercises</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ipums/ipumsr" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://forum.ipums.org" class="external-link">
    <span class="fa fa-users"></span>
     
  </a>
</li>
<li>
  <a href="https://www.ipums.org/" class="external-link">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>IPUMS Data and R</h1>
                        <h4 data-toc-skip class="author">Institute for
Social Research and Data Innovation</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ipums/ipumsr/blob/HEAD/vignettes/ipums.Rmd" class="external-link"><code>vignettes/ipums.Rmd</code></a></small>
      <div class="hidden name"><code>ipums.Rmd</code></div>

    </div>

    
    
<p>This text provides an overview of how to find, request, download, and
read IPUMS data into R. For a general introduction to IPUMS and ipumsr,
see the <a href="https://tech.popdata.org/ipumsr/index.html" class="external-link">ipumsr home
page</a>.</p>
<div class="section level2">
<h2 id="obtaining-ipums-data">Obtaining IPUMS data<a class="anchor" aria-label="anchor" href="#obtaining-ipums-data"></a>
</h2>
<p>IPUMS data are free, but do require registration. New users can
register with a particular <a href="https://www.ipums.org/overview" class="external-link">IPUMS project</a> by clicking the
<strong>Register</strong> link at the top right of the project
website.</p>
<p>Users obtain IPUMS data by creating and submitting an <em>extract
request</em>. This specifies which data to include in the resulting
<em>extract</em> (or <em>data extract</em>). IPUMS servers process each
submitted extract request, and when complete, users can download the
extract containing the requested data.</p>
<p>Extracts typically contain both data and metadata files. Data files
typically come as fixed-width (.dat) files or comma-delimited (.csv)
files. Metadata files contain information about the data file and its
contents, including variable descriptions and parsing instructions for
fixed-width data files. IPUMS microdata projects provide metadata in DDI
(.xml) files. Aggregate data projects provide metadata in either .txt or
.csv formats.</p>
<p>Users can submit extract requests and download extracts via either
the IPUMS website or the IPUMS API, or via ipumsr functions that
interface with the IPUMS API. The API currently supports access to the
extract system only for <a href="https://developer.ipums.org/docs/v2/apiprogram/apis/" class="external-link">certain
IPUMS projects</a>, which also determines the functionality that ipumsr
can support.</p>
<div class="section level3">
<h3 id="obtaining-data-via-an-ipums-website">Obtaining data via an IPUMS website<a class="anchor" aria-label="anchor" href="#obtaining-data-via-an-ipums-website"></a>
</h3>
<p>To create a new extract request via IPUMS websites, navigate to the
extract interface for the IPUMS project of interest by clicking
<strong>Select Data</strong> in the heading of the project website. The
project extract interface allows you to explore what’s available, find
documentation about data concepts and sources, and then specify the data
you’d like to download. The data selection parameters will differ across
projects; see each project’s documentation for more details on the
available options. If you’ve never created an extract for the project
you’re interested in, a good way to learn the basics is to watch a
project-specific video on creating extracts hosted on the <a href="https://www.ipums.org/support/tutorials" class="external-link">IPUMS Tutorials
page</a>.</p>
<div class="section level4">
<h4 id="downloading-from-microdata-projects">Downloading from microdata projects<a class="anchor" aria-label="anchor" href="#downloading-from-microdata-projects"></a>
</h4>
<p>Once your extract is ready, click the green <strong>Download</strong>
button to download the data file. Then, right-click the
<strong>DDI</strong> link in the Codebook column, and select
<strong>Save Link As…</strong> (see below).</p>
<p>Note that some browsers may display different text, but there should
be an option to download the DDI file as .xml. For instance, on Safari,
select <strong>Download Linked File As…</strong>. For ipumsr to read the
metadata, it is necessary to <strong>save the file in .xml format,
<em>not</em> .html format</strong>.</p>
<p><img src="microdata_annotated_screenshot.png" width="1000"></p>
</div>
<div class="section level4">
<h4 id="downloading-from-aggregate-data-projects">Downloading from aggregate data projects<a class="anchor" aria-label="anchor" href="#downloading-from-aggregate-data-projects"></a>
</h4>
<p>Aggregate data projects include data and metadata together in a
single .zip archive file. To download them, simply click on the green
<strong>Tables</strong> button (for tabular data) and/or <strong>GIS
Files</strong> button (for spatial boundary or location data) in the
<strong>Download Data</strong> column.</p>
</div>
</div>
<div class="section level3">
<h3 id="obtaining-data-via-the-ipums-api">Obtaining data via the IPUMS API<a class="anchor" aria-label="anchor" href="#obtaining-data-via-the-ipums-api"></a>
</h3>
<p>Users can also create and submit extract requests within R by using
ipumsr functions that interface with the IPUMS API. The IPUMS API
currently supports access to the extract system for the following
collections:</p>
<ul>
<li><p>IPUMS USA</p></li>
<li><p>IPUMS CPS</p></li>
<li><p>IPUMS International</p></li>
<li><p>IPUMS NHGIS</p></li>
</ul>
<p>The IPUMS API and ipumsr also support access to IPUMS NHGIS metadata,
so users can query NHGIS metadata in R to explore what data are
available and specify NHGIS data requests. At this time, creating
requests for microdata generally requires using the corresponding
project websites to find samples and variables of interest and obtain
their identifiers for use in R extract definitions.</p>
<p>Once you have identified the data you would like to request, the
workflow for requesting and downloading data via API is straightforward.
First, define the parameters of your extract. The available extract
definition options will differ by IPUMS data collection. See the <a href="ipums-api-micro.html">microdata API request</a> and <a href="ipums-api-nhgis.html">NHGIS API request</a> vignettes for more
details on defining an extract. (The NHGIS vignette also discusses how
to access NHGIS metadata.)</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cps_extract_request</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_extract-micro.html">define_extract_cps</a></span><span class="op">(</span></span>
<span>  description <span class="op">=</span> <span class="st">"2018-2019 CPS Data"</span>,</span>
<span>  samples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cps2018_05s"</span>, <span class="st">"cps2019_05s"</span><span class="op">)</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SEX"</span>, <span class="st">"AGE"</span>, <span class="st">"YEAR"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">nhgis_extract_request</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/define_extract_nhgis.html">define_extract_nhgis</a></span><span class="op">(</span></span>
<span>  description <span class="op">=</span> <span class="st">"NHGIS Data via IPUMS API"</span>,</span>
<span>  datasets <span class="op">=</span> <span class="fu"><a href="../reference/ds_spec.html">ds_spec</a></span><span class="op">(</span></span>
<span>    <span class="st">"1990_STF1"</span>,</span>
<span>    data_tables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NP1"</span>, <span class="st">"NP2"</span>, <span class="st">"NP3"</span><span class="op">)</span>,</span>
<span>    geog_levels <span class="op">=</span> <span class="st">"state"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next, submit your extract definition. After waiting for it to
complete, you can download the files directly to your local machine
without ever having to leave R:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">submitted_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/submit_extract.html">submit_extract</a></span><span class="op">(</span><span class="va">extract_request</span><span class="op">)</span></span>
<span><span class="va">downloadable_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wait_for_extract.html">wait_for_extract</a></span><span class="op">(</span><span class="va">submitted_extract</span><span class="op">)</span></span>
<span><span class="va">data_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/download_extract.html">download_extract</a></span><span class="op">(</span><span class="va">downloadable_extract</span><span class="op">)</span></span></code></pre></div>
<p>You can also get the specifications of your previous extract
requests, even if they weren’t made with the API:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">past_extracts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_extract_history.html">get_extract_history</a></span><span class="op">(</span><span class="st">"nhgis"</span><span class="op">)</span></span></code></pre></div>
<p>See the <a href="ipums-api.html">introduction to the IPUMS API for R
users</a> for more details about how to use ipumsr to interact with the
IPUMS API.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-ipums-data">Reading IPUMS data<a class="anchor" aria-label="anchor" href="#reading-ipums-data"></a>
</h2>
<p>Once you have downloaded an extract, you can load the data into R
with the family of <code>read_*()</code> functions in ipumsr. These
functions expand on those provided in <a href="https://readr.tidyverse.org/index.html" class="external-link">readr</a> in two ways:</p>
<ul>
<li><p>ipumsr anticipates standard IPUMS file structures, limiting the
need for users to manually extract and organize their downloaded files
before reading.</p></li>
<li><p>ipumsr uses an extract’s metadata files to automatically attach
contextual information to the data. This allows users to easily identify
variable names, variable descriptions, and labeled data values (from <a href="https://haven.tidyverse.org/" class="external-link">haven</a>), which are common in
IPUMS files.</p></li>
</ul>
<p>For microdata files, use the <code>read_ipums_micro_*()</code>
family:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cps_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"cps_00157.xml"</span><span class="op">)</span></span>
<span><span class="va">cps_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ipums_micro.html">read_ipums_micro</a></span><span class="op">(</span><span class="va">cps_file</span><span class="op">)</span></span>
<span><span class="co">#&gt; Use of data from IPUMS CPS is subject to conditions including that users should cite the data appropriately. Use command `ipums_conditions()` for more details.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;    YEAR SERIAL MONTH     ASECWTH STATEFIP       PERNUM ASECWT INCTOT            </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>962     80 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>476. 55<span style="color: #949494;"> [Wisconsin]</span>      1  <span style="text-decoration: underline;">1</span>476.      <span style="text-decoration: underline;">4</span>883         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>962     80 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>476. 55<span style="color: #949494;"> [Wisconsin]</span>      2  <span style="text-decoration: underline;">1</span>471.      <span style="text-decoration: underline;">5</span>800         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>962     80 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>476. 55<span style="color: #949494;"> [Wisconsin]</span>      3  <span style="text-decoration: underline;">1</span>579. 999<span style="text-decoration: underline;">999</span>998<span style="color: #949494;"> [Missin…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>962     82 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>598. 27<span style="color: #949494;"> [Minnesota]</span>      1  <span style="text-decoration: underline;">1</span>598.     <span style="text-decoration: underline;">14</span>015         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>962     83 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>707. 27<span style="color: #949494;"> [Minnesota]</span>      1  <span style="text-decoration: underline;">1</span>707.     <span style="text-decoration: underline;">16</span>552         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>962     84 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>790. 27<span style="color: #949494;"> [Minnesota]</span>      1  <span style="text-decoration: underline;">1</span>790.      <span style="text-decoration: underline;">6</span>375</span></span></code></pre></div>
<p>For NHGIS files, use <code><a href="../reference/read_nhgis.html">read_nhgis()</a></code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhgis_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"nhgis0972_csv.zip"</span><span class="op">)</span></span>
<span><span class="va">nhgis_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nhgis.html">read_nhgis</a></span><span class="op">(</span><span class="va">nhgis_file</span><span class="op">)</span></span>
<span><span class="co">#&gt; Use of data from NHGIS is subject to conditions including that users should cite the data appropriately. Use command `ipums_conditions()` for more details.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">71</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">25</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (9): GISJOIN, STUSAB, CMSA, PMSA, PMSAA, AREALAND, AREAWAT, ANPSADPI, F...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (13): YEAR, MSA_CMSAA, INTPTLAT, INTPTLNG, PSADC, D6Z001, D6Z002, D6Z003...</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">lgl</span>  (3): DIVISIONA, REGIONA, STATEA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nhgis_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 25</span></span></span>
<span><span class="co">#&gt;   GISJOIN  YEAR STUSAB CMSA  DIVISIONA MSA_CMSAA PMSA       PMSAA REGIONA STATEA</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> G0080    <span style="text-decoration: underline;">1</span>990 OH     28    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">1</span>692 Akron, OH… 0080  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> G0360    <span style="text-decoration: underline;">1</span>990 CA     49    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">4</span>472 Anaheim--… 0360  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> G0440    <span style="text-decoration: underline;">1</span>990 MI     35    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">2</span>162 Ann Arbor… 0440  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> G0620    <span style="text-decoration: underline;">1</span>990 IL     14    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">1</span>602 Aurora--E… 0620  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> G0845    <span style="text-decoration: underline;">1</span>990 PA     78    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">6</span>282 Beaver Co… 0845  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> G0875    <span style="text-decoration: underline;">1</span>990 NJ     70    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">5</span>602 Bergen--P… 0875  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 15 more variables: AREALAND &lt;chr&gt;, AREAWAT &lt;chr&gt;, ANPSADPI &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   FUNCSTAT &lt;chr&gt;, INTPTLAT &lt;dbl&gt;, INTPTLNG &lt;dbl&gt;, PSADC &lt;dbl&gt;, D6Z001 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   D6Z002 &lt;dbl&gt;, D6Z003 &lt;dbl&gt;, D6Z004 &lt;dbl&gt;, D6Z005 &lt;dbl&gt;, D6Z006 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   D6Z007 &lt;dbl&gt;, D6Z008 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>ipumsr also supports the reading of IPUMS shapefiles (spatial
boundary and location files) into the <code>sf</code> format provided by
the <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> package:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"nhgis0972_shape_small.zip"</span><span class="op">)</span></span>
<span><span class="va">nhgis_shp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ipums_sf.html">read_ipums_sf</a></span><span class="op">(</span><span class="va">shp_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nhgis_shp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 8 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -129888.4 ymin: -967051.1 xmax: 1948770 ymax: 751282.5</span></span>
<span><span class="co">#&gt; Projected CRS: USA_Contiguous_Albers_Equal_Area_Conic</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;   PMSA  MSACMSA ALTCMSA GISJOIN GISJOIN2   SHAPE_AREA SHAPE_LEN GISJOIN3 </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 3280  3282    41      G3280   3280      <span style="text-decoration: underline;">2</span>840<span style="text-decoration: underline;">869</span>482.   <span style="text-decoration: underline;">320</span>921. G32823280</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 5760  5602    70      G5760   5760       237<span style="text-decoration: underline;">428</span>573.   <span style="text-decoration: underline;">126</span>226. G56025760</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1145  3362    42      G1145   1145      <span style="text-decoration: underline;">3</span>730<span style="text-decoration: underline;">749</span>183.   <span style="text-decoration: underline;">489</span>789. G33621145</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1920  1922    31      G1920   1920     <span style="text-decoration: underline;">12</span>068<span style="text-decoration: underline;">105</span>590.   <span style="text-decoration: underline;">543</span>164. G19221920</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 0080  1692    28      G0080   0080      <span style="text-decoration: underline;">2</span>401<span style="text-decoration: underline;">347</span>006.   <span style="text-decoration: underline;">218</span>892. G16920080</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1640  1642    21      G1640   1640      <span style="text-decoration: underline;">5</span>608<span style="text-decoration: underline;">404</span>797.   <span style="text-decoration: underline;">415</span>671. G16421640</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: geometry &lt;MULTIPOLYGON [m]&gt;</span></span></span></code></pre></div>
<p>ipumsr is primarily designed to read data produced by the IPUMS
extract system. However, IPUMS does distribute other files, often
available via direct download. In many cases, these can be loaded with
ipumsr. Otherwise, these files can likely be handled by existing data
reading packages like <a href="https://readr.tidyverse.org/" class="external-link">readr</a>
(for delimited files) or <a href="https://haven.tidyverse.org/" class="external-link">haven</a> (for Stata, SPSS, or SAS
files).</p>
<p>See the vignette on <a href="ipums-read.html">reading IPUMS data</a>
for more information.</p>
<div class="section level3">
<h3 id="exploring-file-metadata">Exploring file metadata<a class="anchor" aria-label="anchor" href="#exploring-file-metadata"></a>
</h3>
<p>Load a file’s metadata with <code><a href="../reference/read_ipums_ddi.html">read_ipums_ddi()</a></code> (for
microdata projects) and <code><a href="../reference/read_nhgis_codebook.html">read_nhgis_codebook()</a></code> (for NHGIS).
These provide file- and variable-level metadata for a given data source,
which can be used to interpret the data contents.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cps_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ipums_ddi.html">read_ipums_ddi</a></span><span class="op">(</span><span class="va">cps_file</span><span class="op">)</span></span>
<span><span class="va">nhgis_meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nhgis_codebook.html">read_nhgis_codebook</a></span><span class="op">(</span><span class="va">nhgis_file</span><span class="op">)</span></span></code></pre></div>
<p>Summarize the variable metadata for a dataset using
<code><a href="../reference/ipums_var_info.html">ipums_var_info()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_var_info</a></span><span class="op">(</span><span class="va">cps_meta</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 10</span></span></span>
<span><span class="co">#&gt;   var_name var_label        var_desc val_labels code_instr start   end imp_decim</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> YEAR     Survey year      <span style="color: #949494;">"</span>YEAR r… <span style="color: #949494;">&lt;tibble&gt;</span>   <span style="color: #949494;">"</span>YEAR is …     1     4         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> SERIAL   Household seria… <span style="color: #949494;">"</span>SERIAL… <span style="color: #949494;">&lt;tibble&gt;</span>   <span style="color: #949494;">"</span>SERIAL i…     5     9         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> MONTH    Month            <span style="color: #949494;">"</span>MONTH … <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #BB0000;">NA</span>           10    11         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ASECWTH  Annual Social a… <span style="color: #949494;">"</span>ASECWT… <span style="color: #949494;">&lt;tibble&gt;</span>   <span style="color: #949494;">"</span>ASECWTH …    12    22         4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> STATEFIP State (FIPS cod… <span style="color: #949494;">"</span>STATEF… <span style="color: #949494;">&lt;tibble&gt;</span>    <span style="color: #BB0000;">NA</span>           23    24         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> PERNUM   Person number i… <span style="color: #949494;">"</span>PERNUM… <span style="color: #949494;">&lt;tibble&gt;</span>   <span style="color: #949494;">"</span>PERNUM i…    25    26         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> ASECWT   Annual Social a… <span style="color: #949494;">"</span>ASECWT… <span style="color: #949494;">&lt;tibble&gt;</span>   <span style="color: #949494;">"</span>ASECWT i…    27    37         4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> INCTOT   Total personal … <span style="color: #949494;">"</span>INCTOT… <span style="color: #949494;">&lt;tibble&gt;</span>   <span style="color: #949494;">"</span>99999999…    38    46         0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: var_type &lt;chr&gt;, rectypes &lt;lgl&gt;</span></span></span></code></pre></div>
<p>You can also get contextual details for specific variables:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_var_desc</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">$</span><span class="va">INCTOT</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "INCTOT indicates each respondent's total pre-tax personal income or losses from all sources for the previous calendar year.  Amounts are expressed as they were reported to the interviewer; users must adjust for inflation using Consumer Price Index adjustment factors."</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_val_labels</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">$</span><span class="va">STATEFIP</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 75 × 2</span></span></span>
<span><span class="co">#&gt;      val lbl                 </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 Alabama             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 Alaska              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     4 Arizona             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     5 Arkansas            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     6 California          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     8 Colorado            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     9 Connecticut         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    10 Delaware            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    11 District of Columbia</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    12 Florida             </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 65 more rows</span></span></span></code></pre></div>
<p>ipumsr also provides a family of <code>lbl_*()</code> functions to
assist in accessing and manipulating the value-level metadata included
in IPUMS data. This allows for value labels to be incorporated into the
data processing pipeline. For instance:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove labels for values that do not appear in the data</span></span>
<span><span class="va">cps_data</span><span class="op">$</span><span class="va">STATEFIP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lbl_clean.html">lbl_clean</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">$</span><span class="va">STATEFIP</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_val_labels</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">$</span><span class="va">STATEFIP</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 2</span></span></span>
<span><span class="co">#&gt;     val lbl         </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>    19 Iowa        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    27 Minnesota   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    38 North Dakota</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>    46 South Dakota</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>    55 Wisconsin</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine North and South Dakota into a single value/label pair</span></span>
<span><span class="va">cps_data</span><span class="op">$</span><span class="va">STATEFIP</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lbl_relabel.html">lbl_relabel</a></span><span class="op">(</span></span>
<span>  <span class="va">cps_data</span><span class="op">$</span><span class="va">STATEFIP</span>,</span>
<span>  <span class="fu"><a href="../reference/lbl.html">lbl</a></span><span class="op">(</span><span class="st">"38_46"</span>, <span class="st">"Dakotas"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Dakota"</span>, <span class="va">.lbl</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_val_labels</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">$</span><span class="va">STATEFIP</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   val   lbl      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 19    Iowa     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 27    Minnesota</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 38_46 Dakotas  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 55    Wisconsin</span></span></code></pre></div>
<p>See the <a href="value-labels.html">value labels</a> vignette for
more details.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.ipums.org" class="external-link">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> .</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '4ffa912ace97d2493f6ed39f20e94316',
    indexName: 'ipumsr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
