<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ipumsr">
<title>Reading IPUMS Data • ipumsr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Reading IPUMS Data">
<meta property="og:description" content="ipumsr">
<meta property="og:image" content="http://tech.popdata.org/ipumsr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ipumsr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/ipums.html">Get Started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>IPUMS Data</h6>
    <a class="dropdown-item" href="../articles/ipums-read.html">Read IPUMS data</a>
    <a class="dropdown-item" href="../articles/value-labels.html">Value labels</a>
    <a class="dropdown-item" href="../articles/ipums-bigdata.html">Big IPUMS data</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>IPUMS API</h6>
    <a class="dropdown-item" href="../articles/ipums-api.html">Introduction to the API</a>
    <a class="dropdown-item" href="../articles/ipums-api-micro.html">Microdata API requests</a>
    <a class="dropdown-item" href="../articles/ipums-api-nhgis.html">NHGIS API requests</a>
    <div class="dropdown-divider"></div>
    <a class="external-link dropdown-item" href="https://ipums.org/exercises.shtml">Project-specific exercises</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ipums/ipumsr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://forum.ipums.org">
    <span class="fa fa-users"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.ipums.org/">
    <span class="fa fa-globe"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Reading IPUMS Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ipums/ipumsr/blob/HEAD/vignettes/ipums-read.Rmd" class="external-link"><code>vignettes/ipums-read.Rmd</code></a></small>
      <div class="d-none name"><code>ipums-read.Rmd</code></div>
    </div>

    
    
<p>Once you have downloaded an IPUMS extract, the next step is to load
its data into R for analysis.</p>
<p>For more information about IPUMS data and how to generate and
download a data extract, see the <a href="ipums.html">introduction</a>
to IPUMS data.</p>
<div class="section level2">
<h2 id="ipums-extract-structure">IPUMS extract structure<a class="anchor" aria-label="anchor" href="#ipums-extract-structure"></a>
</h2>
<p>IPUMS extracts will be organized slightly differently for different
<a href="https://www.ipums.org/overview" class="external-link">IPUMS projects</a>. In general,
all projects will provide multiple files in a data extract. The files
most relevant to ipumsr are:</p>
<ul>
<li>The <strong>metadata</strong> file containing information about the
variables included in the extract data</li>
<li>One or more <strong>data</strong> files, depending on the project
and specifications in the extract</li>
</ul>
<p>Both of these files are necessary to properly load data into R.
Obviously, the data files contain the actual data values to be loaded.
But because these are often in fixed-width format, the metadata files
are required to correctly parse the data on load.</p>
<p>Even for .csv files, the metadata file allows for the addition of
contextual variable information to the loaded data. This makes it much
easier to interpret the values in the data variables and effectively use
them in your data processing pipeline. See the <a href="value-labels.html">value labels</a> vignette for more information
on working with these labels.</p>
</div>
<div class="section level2">
<h2 id="reading-microdata-extracts">Reading microdata extracts<a class="anchor" aria-label="anchor" href="#reading-microdata-extracts"></a>
</h2>
<p>Microdata extracts typically provide their metadata in a DDI (.xml)
file separate from the compressed data (.dat.gz) files.</p>
<p>Provide the path to the DDI file to <code><a href="../reference/read_ipums_micro.html">read_ipums_micro()</a></code>
to directly load its associated data file into R.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tech.popdata.org/ipumsr/" class="external-link">ipumsr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example data</span></span>
<span><span class="va">cps_ddi_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"cps_00157.xml"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cps_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ipums_micro.html">read_ipums_micro</a></span><span class="op">(</span><span class="va">cps_ddi_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;    YEAR SERIAL MONTH     ASECWTH STATEFIP       PERNUM ASECWT INCTOT            </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">1</span>962     80 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>476. 55<span style="color: #949494;"> [Wisconsin]</span>      1  <span style="text-decoration: underline;">1</span>476.      <span style="text-decoration: underline;">4</span>883         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>962     80 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>476. 55<span style="color: #949494;"> [Wisconsin]</span>      2  <span style="text-decoration: underline;">1</span>471.      <span style="text-decoration: underline;">5</span>800         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">1</span>962     80 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>476. 55<span style="color: #949494;"> [Wisconsin]</span>      3  <span style="text-decoration: underline;">1</span>579. 999<span style="text-decoration: underline;">999</span>998<span style="color: #949494;"> [Missin…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">1</span>962     82 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>598. 27<span style="color: #949494;"> [Minnesota]</span>      1  <span style="text-decoration: underline;">1</span>598.     <span style="text-decoration: underline;">14</span>015         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  <span style="text-decoration: underline;">1</span>962     83 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>707. 27<span style="color: #949494;"> [Minnesota]</span>      1  <span style="text-decoration: underline;">1</span>707.     <span style="text-decoration: underline;">16</span>552         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  <span style="text-decoration: underline;">1</span>962     84 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>790. 27<span style="color: #949494;"> [Minnesota]</span>      1  <span style="text-decoration: underline;">1</span>790.      <span style="text-decoration: underline;">6</span>375</span></span></code></pre></div>
<p>Note that you provide the path to the DDI file, <em>not</em> the data
file. This is because ipumsr needs to find both the DDI and data files
to read in your data, and the DDI file includes the name of the data
file, whereas the data file contains only the raw data.</p>
<p>The loaded data have been parsed correctly and include variable
metadata in each column. For a summary of the column contents, use
<code><a href="../reference/ipums_var_info.html">ipums_var_info()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_var_info</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 4</span></span></span>
<span><span class="co">#&gt;   var_name var_label                                         var_desc val_labels</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> YEAR     Survey year                                       <span style="color: #949494;">"</span>YEAR r… <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> SERIAL   Household serial number                           <span style="color: #949494;">"</span>SERIAL… <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> MONTH    Month                                             <span style="color: #949494;">"</span>MONTH … <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ASECWTH  Annual Social and Economic Supplement Household … <span style="color: #949494;">"</span>ASECWT… <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> STATEFIP State (FIPS code)                                 <span style="color: #949494;">"</span>STATEF… <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> PERNUM   Person number in sample unit                      <span style="color: #949494;">"</span>PERNUM… <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> ASECWT   Annual Social and Economic Supplement Weight      <span style="color: #949494;">"</span>ASECWT… <span style="color: #949494;">&lt;tibble&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> INCTOT   Total personal income                             <span style="color: #949494;">"</span>INCTOT… <span style="color: #949494;">&lt;tibble&gt;</span></span></span></code></pre></div>
<p>This information is also attached to specific columns. You can obtain
it with <code><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes()</a></code> or by using ipumsr helpers:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">$</span><span class="va">MONTH</span><span class="op">)</span></span>
<span><span class="co">#&gt; $labels</span></span>
<span><span class="co">#&gt;   January  February     March     April       May      June      July    August </span></span>
<span><span class="co">#&gt;         1         2         3         4         5         6         7         8 </span></span>
<span><span class="co">#&gt; September   October  November  December </span></span>
<span><span class="co">#&gt;         9        10        11        12 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $class</span></span>
<span><span class="co">#&gt; [1] "haven_labelled" "vctrs_vctr"     "integer"       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $label</span></span>
<span><span class="co">#&gt; [1] "Month"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var_desc</span></span>
<span><span class="co">#&gt; [1] "MONTH indicates the calendar month of the CPS interview."</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_val_labels</a></span><span class="op">(</span><span class="va">cps_data</span><span class="op">$</span><span class="va">MONTH</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 2</span></span></span>
<span><span class="co">#&gt;      val lbl      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 January  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 February </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3 March    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4 April    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5 May      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6 June     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7 July     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8 August   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9 September</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10 October  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    11 November </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    12 December</span></span></code></pre></div>
<p>While this is the most straightforward way to load microdata, it’s
often advantageous to independently load the DDI file into an
<code>ipums_ddi</code> object containing the metadata:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cps_ddi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ipums_ddi.html">read_ipums_ddi</a></span><span class="op">(</span><span class="va">cps_ddi_file</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cps_ddi</span></span>
<span><span class="co">#&gt; An IPUMS DDI for IPUMS CPS with 8 variables</span></span>
<span><span class="co">#&gt; Extract 'cps_00157.dat' created on 2023-07-10</span></span>
<span><span class="co">#&gt; User notes:  User-provided description: Reproducing cps00006</span></span></code></pre></div>
<p>This is because many common data processing functions have the
side-effect of removing these attributes:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This doesn't actually change the data...</span></span>
<span><span class="va">cps_data2</span> <span class="op">&lt;-</span> <span class="va">cps_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>MONTH <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="va">MONTH</span>, <span class="va">MONTH</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># but removes attributes!</span></span>
<span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_val_labels</a></span><span class="op">(</span><span class="va">cps_data2</span><span class="op">$</span><span class="va">MONTH</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 0 × 2</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 variables: val &lt;dbl&gt;, lbl &lt;chr&gt;</span></span></span></code></pre></div>
<p>In this case, you can always use the separate DDI as a metadata
reference:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_val_labels</a></span><span class="op">(</span><span class="va">cps_ddi</span>, var <span class="op">=</span> <span class="va">MONTH</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 2</span></span></span>
<span><span class="co">#&gt;      val lbl      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 January  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 February </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3 March    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4 April    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5 May      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6 June     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7 July     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8 August   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9 September</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10 October  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    11 November </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    12 December</span></span></code></pre></div>
<p>Or even reattach the metadata, assuming the variable names still
match those in the DDI:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cps_data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_ipums_var_attributes.html">set_ipums_var_attributes</a></span><span class="op">(</span><span class="va">cps_data2</span>, <span class="va">cps_ddi</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_val_labels</a></span><span class="op">(</span><span class="va">cps_data2</span><span class="op">$</span><span class="va">MONTH</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 2</span></span></span>
<span><span class="co">#&gt;      val lbl      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 January  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     2 February </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     3 March    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4 April    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     5 May      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     6 June     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     7 July     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     8 August   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     9 September</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    10 October  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    11 November </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    12 December</span></span></code></pre></div>
<div class="section level3">
<h3 id="hierarchical-extracts">Hierarchical extracts<a class="anchor" aria-label="anchor" href="#hierarchical-extracts"></a>
</h3>
<p>IPUMS microdata can come in either <em>rectangular</em> or
<em>hierarchical</em> format.</p>
<p>Rectangular data are transformed such that every row of data
represents the same type of record. For instance, each row will
represent a person record, and all household-level information for that
person will be included in the same row. (This is the case for
<code>cps_data</code> shown in the <a href="#reading-microdata-extracts">example above</a>.)</p>
<p>Hierarchical data have records of different types interspersed in a
single file. For instance, a household record will be included in its
own row followed by the person records associated with that
household.</p>
<p>Hierarchical data can be loaded in list format or long format.
<code><a href="../reference/read_ipums_micro.html">read_ipums_micro()</a></code> will read in long format:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cps_hier_ddi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ipums_ddi.html">read_ipums_ddi</a></span><span class="op">(</span><span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"cps_00159.xml"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/read_ipums_micro.html">read_ipums_micro</a></span><span class="op">(</span><span class="va">cps_hier_ddi</span><span class="op">)</span></span>
<span><span class="co">#&gt; Use of data from IPUMS CPS is subject to conditions including that users should cite the data appropriately. Use command `ipums_conditions()` for more details.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11,053 × 9</span></span></span>
<span><span class="co">#&gt;    RECTYPE     YEAR SERIAL MONTH    ASECWTH STATEFIP PERNUM ASECWT INCTOT       </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr+lbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+lb&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+lb&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> H<span style="color: #949494;"> [Househ…</span>  <span style="text-decoration: underline;">1</span>962     80  3<span style="color: #949494;"> [Mar…</span>   <span style="text-decoration: underline;">1</span>476. 55<span style="color: #949494;"> [Wis…</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P<span style="color: #949494;"> [Person…</span>  <span style="text-decoration: underline;">1</span>962     80 <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>            1  <span style="text-decoration: underline;">1</span>476.  4.88<span style="color: #949494;">e</span>3      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P<span style="color: #949494;"> [Person…</span>  <span style="text-decoration: underline;">1</span>962     80 <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>            2  <span style="text-decoration: underline;">1</span>471.  5.8 <span style="color: #949494;">e</span>3      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P<span style="color: #949494;"> [Person…</span>  <span style="text-decoration: underline;">1</span>962     80 <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>            3  <span style="text-decoration: underline;">1</span>579.  1.00<span style="color: #949494;">e</span>9<span style="color: #949494;"> [Mis…</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> H<span style="color: #949494;"> [Househ…</span>  <span style="text-decoration: underline;">1</span>962     82  3<span style="color: #949494;"> [Mar…</span>   <span style="text-decoration: underline;">1</span>598. 27<span style="color: #949494;"> [Min…</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P<span style="color: #949494;"> [Person…</span>  <span style="text-decoration: underline;">1</span>962     82 <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>            1  <span style="text-decoration: underline;">1</span>598.  1.40<span style="color: #949494;">e</span>4      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> H<span style="color: #949494;"> [Househ…</span>  <span style="text-decoration: underline;">1</span>962     83  3<span style="color: #949494;"> [Mar…</span>   <span style="text-decoration: underline;">1</span>707. 27<span style="color: #949494;"> [Min…</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P<span style="color: #949494;"> [Person…</span>  <span style="text-decoration: underline;">1</span>962     83 <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>            1  <span style="text-decoration: underline;">1</span>707.  1.66<span style="color: #949494;">e</span>4      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> H<span style="color: #949494;"> [Househ…</span>  <span style="text-decoration: underline;">1</span>962     84  3<span style="color: #949494;"> [Mar…</span>   <span style="text-decoration: underline;">1</span>790. 27<span style="color: #949494;"> [Min…</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P<span style="color: #949494;"> [Person…</span>  <span style="text-decoration: underline;">1</span>962     84 <span style="color: #BB0000;">NA</span>           <span style="color: #BB0000;">NA</span>  <span style="color: #BB0000;">NA</span>            1  <span style="text-decoration: underline;">1</span>790.  6.38<span style="color: #949494;">e</span>3      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11,043 more rows</span></span></span></code></pre></div>
<p>The long format consists of a single <a href="https://tibble.tidyverse.org/reference/tbl_df-class.html" class="external-link"><code>tibble</code></a>
that includes rows with varying record types. In this example, some rows
have a record type of “Household” and others have a record type of
“Person”. Variables that do not apply to a particular record type will
be filled with <code>NA</code> in rows of that record type.</p>
<p>To read data in list format, use
<code><a href="../reference/read_ipums_micro.html">read_ipums_micro_list()</a></code>. This function returns a list where
each element contains all the records for a given record type:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/read_ipums_micro.html">read_ipums_micro_list</a></span><span class="op">(</span><span class="va">cps_hier_ddi</span><span class="op">)</span></span>
<span><span class="co">#&gt; Use of data from IPUMS CPS is subject to conditions including that users should cite the data appropriately. Use command `ipums_conditions()` for more details.</span></span>
<span><span class="co">#&gt; $HOUSEHOLD</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3,385 × 6</span></span></span>
<span><span class="co">#&gt;    RECTYPE               YEAR SERIAL MONTH     ASECWTH STATEFIP      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr+lbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int+lbl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962     80 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>476. 55<span style="color: #949494;"> [Wisconsin]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962     82 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>598. 27<span style="color: #949494;"> [Minnesota]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962     83 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>707. 27<span style="color: #949494;"> [Minnesota]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962     84 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>790. 27<span style="color: #949494;"> [Minnesota]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962    107 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">4</span>355. 19<span style="color: #949494;"> [Iowa]</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962    108 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>479. 19<span style="color: #949494;"> [Iowa]</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962    122 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">3</span>603. 27<span style="color: #949494;"> [Minnesota]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962    124 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">4</span>104. 55<span style="color: #949494;"> [Wisconsin]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962    125 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">2</span>182. 55<span style="color: #949494;"> [Wisconsin]</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> H<span style="color: #949494;"> [Household Record]</span>  <span style="text-decoration: underline;">1</span>962    126 3<span style="color: #949494;"> [March]</span>   <span style="text-decoration: underline;">1</span>826. 55<span style="color: #949494;"> [Wisconsin]</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3,375 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $PERSON</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7,668 × 6</span></span></span>
<span><span class="co">#&gt;    RECTYPE            YEAR SERIAL PERNUM ASECWT INCTOT                          </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr+lbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl+lbl&gt;</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962     80      1  <span style="text-decoration: underline;">1</span>476.      <span style="text-decoration: underline;">4</span>883                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962     80      2  <span style="text-decoration: underline;">1</span>471.      <span style="text-decoration: underline;">5</span>800                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962     80      3  <span style="text-decoration: underline;">1</span>579. 999<span style="text-decoration: underline;">999</span>998<span style="color: #949494;"> [Missing. (1962-1964 …</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962     82      1  <span style="text-decoration: underline;">1</span>598.     <span style="text-decoration: underline;">14</span>015                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962     83      1  <span style="text-decoration: underline;">1</span>707.     <span style="text-decoration: underline;">16</span>552                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962     84      1  <span style="text-decoration: underline;">1</span>790.      <span style="text-decoration: underline;">6</span>375                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962    107      1  <span style="text-decoration: underline;">4</span>355. 999<span style="text-decoration: underline;">999</span>999<span style="color: #949494;"> [N.I.U.]</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962    107      2  <span style="text-decoration: underline;">1</span>386.         0                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962    107      3  <span style="text-decoration: underline;">1</span>629.       600                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> P<span style="color: #949494;"> [Person Record]</span>  <span style="text-decoration: underline;">1</span>962    107      4  <span style="text-decoration: underline;">1</span>432. 999<span style="text-decoration: underline;">999</span>999<span style="color: #949494;"> [N.I.U.]</span>              </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 7,658 more rows</span></span></span></code></pre></div>
<p><code><a href="../reference/read_ipums_micro.html">read_ipums_micro()</a></code> and
<code><a href="../reference/read_ipums_micro.html">read_ipums_micro_list()</a></code> also support partial loading by
selecting only a subset of columns or a limited number of rows. See the
documentation for more details about other options.</p>
</div>
</div>
<div class="section level2">
<h2 id="reading-ipums-nhgis-extracts">Reading IPUMS NHGIS extracts<a class="anchor" aria-label="anchor" href="#reading-ipums-nhgis-extracts"></a>
</h2>
<p>Unlike microdata projects, NHGIS extracts provide their data and
metadata files bundled into a single .zip archive.
<code><a href="../reference/read_nhgis.html">read_nhgis()</a></code> anticipates this structure and can read data
files directly from this file without the need to manually extract the
files:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhgis_ex1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"nhgis0972_csv.zip"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nhgis_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nhgis.html">read_nhgis</a></span><span class="op">(</span><span class="va">nhgis_ex1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Use of data from NHGIS is subject to conditions including that users should cite the data appropriately. Use command `ipums_conditions()` for more details.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">71</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">25</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (9): GISJOIN, STUSAB, CMSA, PMSA, PMSAA, AREALAND, AREAWAT, ANPSADPI, F...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (13): YEAR, MSA_CMSAA, INTPTLAT, INTPTLNG, PSADC, D6Z001, D6Z002, D6Z003...</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">lgl</span>  (3): DIVISIONA, REGIONA, STATEA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="va">nhgis_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 71 × 25</span></span></span>
<span><span class="co">#&gt;    GISJOIN  YEAR STUSAB CMSA  DIVISIONA MSA_CMSAA PMSA      PMSAA REGIONA STATEA</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> G0080    <span style="text-decoration: underline;">1</span>990 OH     28    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">1</span>692 Akron, O… 0080  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> G0360    <span style="text-decoration: underline;">1</span>990 CA     49    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">4</span>472 Anaheim-… 0360  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> G0440    <span style="text-decoration: underline;">1</span>990 MI     35    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">2</span>162 Ann Arbo… 0440  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> G0620    <span style="text-decoration: underline;">1</span>990 IL     14    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">1</span>602 Aurora--… 0620  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> G0845    <span style="text-decoration: underline;">1</span>990 PA     78    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">6</span>282 Beaver C… 0845  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> G0875    <span style="text-decoration: underline;">1</span>990 NJ     70    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">5</span>602 Bergen--… 0875  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> G1120    <span style="text-decoration: underline;">1</span>990 MA     07    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">1</span>122 Boston, … 1120  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> G1125    <span style="text-decoration: underline;">1</span>990 CO     34    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">2</span>082 Boulder-… 1125  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> G1145    <span style="text-decoration: underline;">1</span>990 TX     42    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">3</span>362 Brazoria… 1145  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> G1160    <span style="text-decoration: underline;">1</span>990 CT     70    <span style="color: #BB0000;">NA</span>             <span style="text-decoration: underline;">5</span>602 Bridgepo… 1160  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 61 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 15 more variables: AREALAND &lt;chr&gt;, AREAWAT &lt;chr&gt;, ANPSADPI &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   FUNCSTAT &lt;chr&gt;, INTPTLAT &lt;dbl&gt;, INTPTLNG &lt;dbl&gt;, PSADC &lt;dbl&gt;, D6Z001 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   D6Z002 &lt;dbl&gt;, D6Z003 &lt;dbl&gt;, D6Z004 &lt;dbl&gt;, D6Z005 &lt;dbl&gt;, D6Z006 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   D6Z007 &lt;dbl&gt;, D6Z008 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Like microdata extracts, the data include variable-level metadata,
where available:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">nhgis_data</span><span class="op">$</span><span class="va">D6Z001</span><span class="op">)</span></span>
<span><span class="co">#&gt; $label</span></span>
<span><span class="co">#&gt; [1] "Total area: 1989 to March 1990"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var_desc</span></span>
<span><span class="co">#&gt; [1] "Table D6Z: Year Structure Built (Universe: Housing Units)"</span></span></code></pre></div>
<p>However, variable metadata for NHGIS data are slightly different than
those provided by microdata products. First, they come from a .txt
codebook file rather than an .xml DDI file. Codebooks can still be
loaded into an <code>ipums_ddi</code> object, but fields that do not
apply to aggregate data will be empty. In general, NHGIS codebooks
provide only variable labels and descriptions, along with citation
information.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhgis_cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nhgis_codebook.html">read_nhgis_codebook</a></span><span class="op">(</span><span class="va">nhgis_ex1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Most useful metadata for NHGIS is for variable labels:</span></span>
<span><span class="fu"><a href="../reference/ipums_var_info.html">ipums_var_info</a></span><span class="op">(</span><span class="va">nhgis_cb</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">var_name</span>, <span class="va">var_label</span>, <span class="va">var_desc</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 25 × 3</span></span></span>
<span><span class="co">#&gt;    var_name  var_label                                                  var_desc</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> GISJOIN   GIS Join Match Code                                        <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> YEAR      Data File Year                                             <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> STUSAB    State/US Abbreviation                                      <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> CMSA      Consolidated Metropolitan Statistical Area                 <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> DIVISIONA Division Code                                              <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> MSA_CMSAA Metropolitan Statistical Area/Consolidated Metropolitan S… <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> PMSA      Primary Metropolitan Statistical Area Name                 <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> PMSAA     Primary Metropolitan Statistical Area Code                 <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> REGIONA   Region Code                                                <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> STATEA    State Code                                                 <span style="color: #949494;">""</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 15 more rows</span></span></span></code></pre></div>
<p>By design, NHGIS codebooks are human-readable, and it may be easier
to interpret their contents in raw format. To view the codebook itself
without converting to an <code>ipums_ddi</code> object, set
<code>raw = TRUE</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhgis_cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nhgis_codebook.html">read_nhgis_codebook</a></span><span class="op">(</span><span class="va">nhgis_ex1</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">nhgis_cb</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Codebook for NHGIS data file 'nhgis0972_ds135_1990_pmsa'</span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Contents</span></span>
<span><span class="co">#&gt;     - Data Summary</span></span>
<span><span class="co">#&gt;     - Data Dictionary</span></span>
<span><span class="co">#&gt;     - Citation and Use</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Additional documentation on NHGIS data sources is available at: </span></span>
<span><span class="co">#&gt;     https://www.nhgis.org/documentation/tabular-data </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Data Summary</span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Year:             1990</span></span>
<span><span class="co">#&gt; Geographic level: Consolidated Metropolitan Statistical Area--Primary Metropolitan Statistical Area</span></span>
<span><span class="co">#&gt; Dataset:          1990 Census: SSTF 9 - Housing Characteristics of New Units</span></span>
<span><span class="co">#&gt;    NHGIS code:    1990_SSTF09</span></span></code></pre></div>
<div class="section level3">
<h3 id="handling-multiple-files">Handling multiple files<a class="anchor" aria-label="anchor" href="#handling-multiple-files"></a>
</h3>
<p>For more complicated NHGIS extracts that include data from multiple
data sources, the provided .zip archive will contain multiple codebook
and data files.</p>
<p>You can view the files contained in an extract to determine if this
is the case:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhgis_ex2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"nhgis0731_csv.zip"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ipums_list_files.html">ipums_list_files</a></span><span class="op">(</span><span class="va">nhgis_ex2</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   type  file                                          </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> data  nhgis0731_csv/nhgis0731_ds239_20185_nation.csv</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> data  nhgis0731_csv/nhgis0731_ts_nominal_state.csv</span></span></code></pre></div>
<p>In these cases, you can use the <code>file_select</code> argument to
indicate which file to load. <code>file_select</code> supports most
features of the <a href="https://tidyselect.r-lib.org/reference/language.html" class="external-link">tidyselect
selection language</a>. (See <code><a href="../reference/selection_language.html">?selection_language</a></code> for
documentation of the features supported in ipumsr.)</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhgis_data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nhgis.html">read_nhgis</a></span><span class="op">(</span><span class="va">nhgis_ex2</span>, file_select <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"nation"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nhgis_data3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nhgis.html">read_nhgis</a></span><span class="op">(</span><span class="va">nhgis_ex2</span>, file_select <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"ts_nominal_state"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The matching codebook should automatically be loaded and attached to
the data:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">nhgis_data2</span><span class="op">$</span><span class="va">AJWBE001</span><span class="op">)</span></span>
<span><span class="co">#&gt; $label</span></span>
<span><span class="co">#&gt; [1] "Estimates: Total"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var_desc</span></span>
<span><span class="co">#&gt; [1] "Table AJWB: Sex by Age (Universe: Total population)"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">nhgis_data3</span><span class="op">$</span><span class="va">A00AA1790</span><span class="op">)</span></span>
<span><span class="co">#&gt; $label</span></span>
<span><span class="co">#&gt; [1] "1790: Persons: Total"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var_desc</span></span>
<span><span class="co">#&gt; [1] "Table A00: Total Population"</span></span></code></pre></div>
<p>(If for some reason the codebook is not loaded correctly, you can
load it separately with <code><a href="../reference/read_nhgis_codebook.html">read_nhgis_codebook()</a></code>, which also
accepts a <code>file_select</code> specification.)</p>
<p><code>file_select</code> also accepts the full path or the index of
the file to load:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Match by file name</span></span>
<span><span class="fu"><a href="../reference/read_nhgis.html">read_nhgis</a></span><span class="op">(</span><span class="va">nhgis_ex2</span>, file_select <span class="op">=</span> <span class="st">"nhgis0731_csv/nhgis0731_ds239_20185_nation.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Match first file in extract</span></span>
<span><span class="fu"><a href="../reference/read_nhgis.html">read_nhgis</a></span><span class="op">(</span><span class="va">nhgis_ex2</span>, file_select <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nhgis-data-formats">NHGIS data formats<a class="anchor" aria-label="anchor" href="#nhgis-data-formats"></a>
</h3>
<div class="section level4">
<h4 id="csv-data">CSV data<a class="anchor" aria-label="anchor" href="#csv-data"></a>
</h4>
<p>NHGIS data are most easily handled in .csv format.
<code><a href="../reference/read_nhgis.html">read_nhgis()</a></code> uses <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code> to handle
the generation of column type specifications. If the guessed
specifications are incorrect, you can use the <code>col_types</code>
argument to adjust. This is most likely to occur for columns that
contain geographic codes that are stored as numeric values:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert MSA codes to character format</span></span>
<span><span class="fu"><a href="../reference/read_nhgis.html">read_nhgis</a></span><span class="op">(</span></span>
<span>  <span class="va">nhgis_ex1</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>MSA_CMSAA <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 71 × 25</span></span></span>
<span><span class="co">#&gt;    GISJOIN  YEAR STUSAB CMSA  DIVISIONA MSA_CMSAA PMSA      PMSAA REGIONA STATEA</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> G0080    <span style="text-decoration: underline;">1</span>990 OH     28    <span style="color: #BB0000;">NA</span>        1692      Akron, O… 0080  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> G0360    <span style="text-decoration: underline;">1</span>990 CA     49    <span style="color: #BB0000;">NA</span>        4472      Anaheim-… 0360  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> G0440    <span style="text-decoration: underline;">1</span>990 MI     35    <span style="color: #BB0000;">NA</span>        2162      Ann Arbo… 0440  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> G0620    <span style="text-decoration: underline;">1</span>990 IL     14    <span style="color: #BB0000;">NA</span>        1602      Aurora--… 0620  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> G0845    <span style="text-decoration: underline;">1</span>990 PA     78    <span style="color: #BB0000;">NA</span>        6282      Beaver C… 0845  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> G0875    <span style="text-decoration: underline;">1</span>990 NJ     70    <span style="color: #BB0000;">NA</span>        5602      Bergen--… 0875  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> G1120    <span style="text-decoration: underline;">1</span>990 MA     07    <span style="color: #BB0000;">NA</span>        1122      Boston, … 1120  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> G1125    <span style="text-decoration: underline;">1</span>990 CO     34    <span style="color: #BB0000;">NA</span>        2082      Boulder-… 1125  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> G1145    <span style="text-decoration: underline;">1</span>990 TX     42    <span style="color: #BB0000;">NA</span>        3362      Brazoria… 1145  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> G1160    <span style="text-decoration: underline;">1</span>990 CT     70    <span style="color: #BB0000;">NA</span>        5602      Bridgepo… 1160  <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 61 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 15 more variables: AREALAND &lt;chr&gt;, AREAWAT &lt;chr&gt;, ANPSADPI &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   FUNCSTAT &lt;chr&gt;, INTPTLAT &lt;dbl&gt;, INTPTLNG &lt;dbl&gt;, PSADC &lt;dbl&gt;, D6Z001 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   D6Z002 &lt;dbl&gt;, D6Z003 &lt;dbl&gt;, D6Z004 &lt;dbl&gt;, D6Z005 &lt;dbl&gt;, D6Z006 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   D6Z007 &lt;dbl&gt;, D6Z008 &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="fixed-width-data">Fixed-width data<a class="anchor" aria-label="anchor" href="#fixed-width-data"></a>
</h4>
<p><code><a href="../reference/read_nhgis.html">read_nhgis()</a></code> also handles NHGIS files provided in
fixed-width format:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhgis_fwf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"nhgis0730_fixed.zip"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nhgis_fwf_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_nhgis.html">read_nhgis</a></span><span class="op">(</span><span class="va">nhgis_fwf</span>, file_select <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches</a></span><span class="op">(</span><span class="st">"ts_nominal"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Use of data from NHGIS is subject to conditions including that users should cite the data appropriately. Use command `ipums_conditions()` for more details.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">84</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">28</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (4): GISJOIN, STATE, STATEFP, STATENH</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (24): A00AA1790, A00AA1800, A00AA1810, A00AA1820, A00AA1830, A00AA1840, ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span></span>
<span><span class="va">nhgis_fwf_data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 84 × 28</span></span></span>
<span><span class="co">#&gt;    GISJOIN STATE         STATEFP STATENH A00AA1790 A00AA1800 A00AA1810 A00AA1820</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> G010    Alabama       01      010            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>    <span style="text-decoration: underline;">127</span>901</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> G020    Alaska        02      020            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> G025    Alaska Terri… <span style="color: #BB0000;">NA</span>      025            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> G040    Arizona       04      040            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> G045    Arizona Terr… <span style="color: #BB0000;">NA</span>      045            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> G050    Arkansas      05      050            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> G055    Arkansas Ter… <span style="color: #BB0000;">NA</span>      055            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>     <span style="text-decoration: underline;">14</span>273</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> G060    California    06      060            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> G080    Colorado      08      080            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> G085    Colorado Ter… <span style="color: #BB0000;">NA</span>      085            <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 74 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 20 more variables: A00AA1830 &lt;dbl&gt;, A00AA1840 &lt;dbl&gt;, A00AA1850 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   A00AA1860 &lt;dbl&gt;, A00AA1870 &lt;dbl&gt;, A00AA1880 &lt;dbl&gt;, A00AA1890 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   A00AA1900 &lt;dbl&gt;, A00AA1910 &lt;dbl&gt;, A00AA1920 &lt;dbl&gt;, A00AA1930 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   A00AA1940 &lt;dbl&gt;, A00AA1950 &lt;dbl&gt;, A00AA1960 &lt;dbl&gt;, A00AA1970 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   A00AA1980 &lt;dbl&gt;, A00AA1990 &lt;dbl&gt;, A00AA2000 &lt;dbl&gt;, A00AA2010 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   A00AA2020 &lt;dbl&gt;</span></span></span></code></pre></div>
<p>The correct parsing of NHGIS fixed-width files is driven by the
column parsing information contained in the .do file provided in the
.zip archive. This contains information not only about column positions
and data types, but also implicit decimals in the data.</p>
<p>If you no longer have access to the .do file, it is best to resubmit
and/or re-download the extract (you may also consider converting to .csv
format in the process). If you have moved the .do file, provide its file
path to the <code>do_file</code> argument to use its column parsing
information.</p>
<p>Note that unlike <code><a href="../reference/read_ipums_micro.html">read_ipums_micro()</a></code>, fixed-width files
for NHGIS are still handled by providing the path to the <em>data
file</em>, not the <em>metadata file</em> (i.e. you cannot provide an
<code>ipums_ddi</code> object to the <code>data_file</code> argument of
<code><a href="../reference/read_nhgis.html">read_nhgis()</a></code>). This is for syntactical consistency with the
loading of NHGIS .csv files.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reading-spatial-data">Reading spatial data<a class="anchor" aria-label="anchor" href="#reading-spatial-data"></a>
</h2>
<p>IPUMS distributes spatial data for several projects.</p>
<ul>
<li>For microdata projects, spatial data are distributed in shapefiles
on dedicated geography pages separate from the standard extract system.
Look for a <strong>Geography and GIS</strong> link in the
<strong>Supplemental Data</strong> section of the project’s website to
find spatial data files and information.</li>
<li>For NHGIS, spatial data can be obtained within the extract system.
Shapefiles will be distributed in their own .zip archive alongside the
.zip archive containing the extract’s tabular data (if any tabular data
are requested).</li>
</ul>
<p>Use <code><a href="../reference/read_ipums_sf.html">read_ipums_sf()</a></code> to load spatial data from any of
these sources as an <code>sf</code> object from <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a>.</p>
<p><code><a href="../reference/read_ipums_sf.html">read_ipums_sf()</a></code> also supports the loading of spatial
files within .zip archives and the <code>file_select</code> syntax for
file selection when multiple internal files are present.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nhgis_shp_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_example.html">ipums_example</a></span><span class="op">(</span><span class="st">"nhgis0972_shape_small.zip"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_ipums_sf.html">read_ipums_sf</a></span><span class="op">(</span><span class="va">nhgis_shp_file</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">shp_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 6 features and 8 fields</span></span>
<span><span class="co">#&gt; Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -129888.4 ymin: -967051.1 xmax: 1948770 ymax: 751282.5</span></span>
<span><span class="co">#&gt; Projected CRS: USA_Contiguous_Albers_Equal_Area_Conic</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 9</span></span></span>
<span><span class="co">#&gt;   PMSA  MSACMSA ALTCMSA GISJOIN GISJOIN2   SHAPE_AREA SHAPE_LEN GISJOIN3 </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 3280  3282    41      G3280   3280      <span style="text-decoration: underline;">2</span>840<span style="text-decoration: underline;">869</span>482.   <span style="text-decoration: underline;">320</span>921. G32823280</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 5760  5602    70      G5760   5760       237<span style="text-decoration: underline;">428</span>573.   <span style="text-decoration: underline;">126</span>226. G56025760</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 1145  3362    42      G1145   1145      <span style="text-decoration: underline;">3</span>730<span style="text-decoration: underline;">749</span>183.   <span style="text-decoration: underline;">489</span>789. G33621145</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1920  1922    31      G1920   1920     <span style="text-decoration: underline;">12</span>068<span style="text-decoration: underline;">105</span>590.   <span style="text-decoration: underline;">543</span>164. G19221920</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 0080  1692    28      G0080   0080      <span style="text-decoration: underline;">2</span>401<span style="text-decoration: underline;">347</span>006.   <span style="text-decoration: underline;">218</span>892. G16920080</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1640  1642    21      G1640   1640      <span style="text-decoration: underline;">5</span>608<span style="text-decoration: underline;">404</span>797.   <span style="text-decoration: underline;">415</span>671. G16421640</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: geometry &lt;MULTIPOLYGON [m]&gt;</span></span></span></code></pre></div>
<p>These data can then be joined to associated tabular data. To preserve
IPUMS attributes from the tabular data used in the join, use an
<code>ipums_shape_*_join()</code> function:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">joined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipums_shape_join.html">ipums_shape_left_join</a></span><span class="op">(</span></span>
<span>  <span class="va">nhgis_data</span>,</span>
<span>  <span class="va">shp_data</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"GISJOIN"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">joined_data</span><span class="op">$</span><span class="va">MSA_CMSAA</span><span class="op">)</span></span>
<span><span class="co">#&gt; $label</span></span>
<span><span class="co">#&gt; [1] "Metropolitan Statistical Area/Consolidated Metropolitan Statistical Area Code"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var_desc</span></span>
<span><span class="co">#&gt; [1] ""</span></span></code></pre></div>
<p>For NHGIS data, the join code typically corresponds to the
<code>GISJOIN</code> variable. However, for microdata projects, the
variable name used for a geographic level in the tabular data may differ
from that in the spatial data. Consult the documentation and metadata
for these files to identify the correct join columns and use the
<code>by</code> argument to join on these columns.</p>
<p>Once joined, data include both statistical and spatial information
along with the variable metadata.</p>
<div class="section level3">
<h3 id="harmonized-vs--non-harmonized-data">Harmonized vs. non-harmonized data<a class="anchor" aria-label="anchor" href="#harmonized-vs--non-harmonized-data"></a>
</h3>
<p>Longitudinal analysis of geographic data is complicated by the fact
that geographic boundaries shift over time. IPUMS therefore provides
multiple types of spatial data:</p>
<ul>
<li>Harmonized (also called “integrated” or “consistent”) files have
been made consistent over time by combining geographies that share area
for different time periods.</li>
<li>Non-harmonized, or year-specific, files represent geographies at a
specific point in time.</li>
</ul>
<p>Furthermore, some NHGIS time series tables have been standardized
such that the statistics have been adjusted to apply to a year-specific
geographical boundary.</p>
<p>When using spatial data, it is important to consult the
project-specific documentation to ensure you are using the most
appropriate boundaries for your research question and the data included
in your analysis. As always, documentation for the IPUMS project you’re
working with should explain the different options available.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://www.ipums.org" class="external-link">IPUMS</a> at the University of Minnesota.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
